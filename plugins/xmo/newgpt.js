/**
 * @author Merrick
 * @name newgpt
 * @origin xmo
 * @version 1.2.1
 * @description ChatGpt聊天，适配无界3.0
 * @team xmo
 * @rule ^(ainewgpt|ainewgptc|ainewdraw) ([\s\S]+)$
 * @rule ^(ainewgpt|ainewgptc)$
 * @admin false
 * @public true
 * @priority 99999
 * @classification ["插件"]
 * @disable false
 * @systemVersion >=:3.0.0
 * @authentication true
 */

/* 
基于sumuen大佬的插件修改，主要是适配了2.0界面，按自己的使用习惯进行了一些调整，原插件在这里https://github.com/sumuen/Bncr_plugin/blob/main/Bncr_ChatGPT.js
需要ApiKey，没有的可以看看这个项目https://github.com/aurora-develop/aurora

v1.0.1 修复了QQ和微信平台在编辑模式下不能正常回复的bug
v1.0.2 跟进大佬修改了调用chatgpt模块，用got发送请求（虽然我不懂但是我会复制粘贴）
v1.0.3 因为前期搭建的项目有问题，调试的时候找不到原因，干脆把代码重新梳理了一遍，具体改动如下：
       1. 修改api的调用方式，采用ChatGPT API官方文档里的方式调用，去除了原作者大量的错误处理代码，大幅度精简了代码
       2. 添加画图功能，设定需要单独配置画图的各项参数，方便用户的不同需求
       3. 修改HumanTG的编辑回复功能，可以支持各种回复类型（前提是适配器支持）
       注意：这个版本最主要是加入了画图功能，如果不需要画图也可以不更新，因为新的调用方式我没有深入测试，不确定比原作者的got方式更好，更新的话需要同步更新prompts.json文件
v1.0.4 适配无界3.0      

todo（其实是我想做不会做，大佬带我~~~~~）
1.用更优雅的方式实现HumanTG的编辑回复和直接回复的切换
2.选择预设角色的时候可以把Prompt直接显示出来，方便调整（下拉列表框和文本框联动）
3.添加画图功能（大佬的代码已经实现了，我没有4.0的ApiKey，无法测试）✔
*/

/** Code Encryption Block[be188605b2af9d5e9f0e7db22a9634fc212a7ad0a1e72494f09b567ed405599e3a6969c7bfc1217e57a59f2120e0f9542850a3d41954a72effbd7a1d5c4eab4bf188beb4f3e3dbec38f4ae588c4f37080b06085c349e7e725519765f0d138b461a28ed42fe7e883b0eb70234cde01738624108424084077d17630ced0cb199a8171e6aaf17cf64933c3ef4c8b1e11daadde35f592c013bf37ee4537a95dd3a7c2b22416cf55052d6073c6cc14edab78009a388351d452c06f44272ae84fb6586c8ed5b4667bf2859ed80006e6f9917c97962b44b4a62fa01dddef3e2a2930d71e9755cb394163dcf128776391432d9525a7969cd380d0c6d88bae4bbbee3038b10122f82953c1c9fa62366e3c1d6170f2ced4177eaec63c5a149e730c86b5de4f29c2a714d0d11abe211c90d954904b82551d27a18b3fde5e9fbb601e53835a0097e3169f1925726c1cb16b835c2e3f83ac46f82b1297bf9c9aa3d0fa10cd692ef82c6d3cb9cf4b0d8464b60387e98bf98b25fb58efbe0cd3c1f810472f4c82b2e79c1ca9a8d7c3c90ce8b30af216434185db87dcb0226a72e91ffbfa3f1b28e4459620794e7d1f78ab736f2a3d7b7f9211e65502fbe59ab72b2b74b121648eac744182b876e6260875b24445f9f6a8cbbc4c9f1af4e1041e3a53643fa9baf97a3e17b3c60b91ccacd3c1162163a15d69923c6bded45258971353c3608d10bb638fda2f26623e9149b22c640580464555872331f70a5248f0b11b9e034b2f09d3bd55bb2f89c345fed47288f6e9029f0e653bcb2145326353cae3898545f3cdedf38bf0b3d3f1d21e0c51f85a0e0aea30a2cc3f253e52b8965977d48bb7dd957f91c8ad68b8ff993445a1dd216305a3b411580a21ed1d590403db80463b776a0527067f93bafaef7679572f32ab4f40aa85179cadbbf4a30a866c165fff6d7fdb6818800b3d2f846015fc5615fbddf8d1a30cd1a18f3b84087d6fc8a0bf519dd1b3065a6eef5f10ad0a352f84facaf4dfb3c08cd9ea8dfc1bad4e0813c834aded5c5183d616e8bac94a4f01e4eb79f37f701af4a458e5bc986968eb0c79637cef68a69ea255808a7833c324425904dc5033515e3b2b6fd375bf5c205fc0b836efe4d1addf27e881f24b0c65d484d6d9d306fa3c83f724f9b04241f570ce5b90077a87f89406768b95ae39ad1cee9c5963ecd228e7a74dc48e07993668a22f14c0189e3271b4679a3fe32a09e9f57026e541f0f36a54ed240d3317678fe13b58049e9da46493234c5b0d83051db38a4f5e851641616017557729333607753c5e339c78a767b21d9e06b6f540503b6f255629ebfb00f92244247c58b74820f44cfa4152b301457062c1201245bb00991d92629ea3c9cb0bfb14e8aa43089c2d2f0ad524414821b9a8103c09f8e889c04e83d4314e7bfb6588e33981bce8cdb2c4ce623a06f48950aae4519a684d4a7aeb72091215e69c6ff370ecd667650012b97c3094814a953d8f462a724d575c42b93c38f76177fc9a8cefc577a7606072d9d77d5532dc10d85cb2ec85b030de15e54247cbf40ea65553ece788ee4d51b8188139cacda59ec4c79d2853d5d63bdbcb3a453efaebf7f8486cf4c3878914839d03fa3a40b547486cc2e4ef3a4e644717abe4fd714582855d141d5323cea92e1708b26dfb9e13e56daad7a61045697a7b68377e215575da0bcdfcbf04ef6f5e128aaf6b0ebc5e7638b47ccbe180f376c0254197a861cc75610dcbf79dc567c4acefb2fcda8f4afb3690a3a0bb82462daa140a0d16df76e4d84dcbc4ec948606d71d18fdf51bbba3067dde01aeb55364b92d2db475c32a6ad6a0f4640255668b98d7f359146bbdc95b090d7c9dc00c4cb55a617d6b419b0fcd9338bec97612e41a555a56e60bad459d48c28a462a24e7547680875fe9ae64819545fb3a17b61f1f540f22b7f0c3e29300cef102d5897e0f29177fcb3470436ffed08fa8f1c62f37484f558cd97ab1c4adff07fea5ae949575e2bacb8dae6ac8756e17f44a177b0875287f7586be8d55cc1ba21809aadf6ad8283106196929383a8bae053dc058c56b7230e13a917ffa7bdeb32898f8ce34d5d23bc2f056e649e9d7d6190aabe22400e13ff6cf8028555a2cc0607c3f0771e4b76cf59486856a4fd4eee7d051fb3d72c08c57b512c30f5107d07cd63c2cb8e3d0c9164eb99dfd604262f7bf1d493d2e9b0c2378d04935119959d33edce7819d01f580d64339ec5337a3f457c5996e25f54dbe6c3e7abf62bb9b03d68bc168517bd285a0aff196ef58b4a81d70888fecca050f90dece7e4da7c7b86bb42a1e1d3fa6f7eb5099395f40d10b327d3ec04abcd768c1be886532a5e1aa4164c8ac6d648ee69e4a926289e53e92d488d6dca8ab6eb0ee05045b60b18e67c1ed19260dd20563b14f491f7c4499ab19770ba382510140d08331411e6f2301e85e5978c548e7d711f15638f2051ac73f1114217e1abcd35d71951a3efb30b00297d47cc01f5e04634c78d120ffb11abd574964ec0342011cadd3d17814595cbd192ac2bec76b3802ed31ed4774fca9811ac7a2f59765c6a2b7298770019433860a3c07c36e78fd4e318debb45ef5f49abb8270bfafb0698aceb686ab93b764b3c4b7659f6a891d91bae970f76937af0bb9f10dc35855f1f06be7a3422117888514204acc08017def76a69bef5649c496fd0877196c32934bea4032988e24cf68cb8e602a10e4f2d31607f41a66256df8fe5601ce1f3c4f775612015f23d6ffa23c80cadf243769beae07b450c2240f1d2de564146279ad480c12568004e7bbc2f212a97372418b7f11ed7adf4c478e22a03edc19d1a49dbebb97fee80bf7a4a0bc1450de196dee074bbe8a95050a9ebe10086de45aab82ee067d1eef8c17656d9e82a2c0c5c12c8e80ed98ffd024878fa1c98743c7002458d4bb81bf5317c97b4478c3c16aa6c6e2328c6368700ebfde1146bf562d38f3d33c97bc7941dbe05a2d1e9af4b7a58ae6d4761873b8ca22ab8af91e0dd459d6ee35ebbc7fd18dac697e9d0b4cc741f56b5e73f42498d8bfb94963c53a61260134d2e1c76436997be499438a44a7b3b914bc706cdd9b583fbf3d139cad91a373736ec8ac5d0b59dabe942965269dab2149c95e5029ceb9995e8c0a8782fc58ba82e8c426faf0b126cf7e60e888ee7bb6f617011d1b34aad092cd23cde988fa9a12449fd44d9a21a060947b6af536add95a368a323340e8d9d1598156f58ba009ce501320265365c9b39d01d189bb33566277251ce2222f6f85a2190151b0dac98250c397fb7e422e34e91ec3c29aec1f2d0ad2747f9f9c2a469903ff4b1c9e92077f25fc6103a862e70e7de2fa85d20cf22fab2b26ee71cca2368bc1097cd89c541e5974fa7a244051ea8c8b102d84ceb3f65703f2280376d1982512e08c7647473c06e028704404f6e78fa3d67a15f528ccaef804dfc128a0820d3543f439bb1c85264cf7f64800a0cdd144edf20672cf991cf946da90bc04e289072dc350611e55381451b693f40d6e830ec353646daf567e03a09e57e2eb45b1aa265df683c70e2b42399a904aff22a7d4761b6166412e02990a162098d026675a878b92a9ea01e2b7b7d014a51d5df72dc0aa5b7024091a815736ab6438cadfdc3320ab2f6e9b3a697ef47aa1c6cb42976a92e431cef36730642dc975d37a717e6f9f717a2ab167c9b770d42a5370a03d7eb4f6f2a293f13bd26cc9e7f0559cee6b00ba6b93ee91e8ae9c7baa1635364075a94937a0742dd009113c63d80d6748521308a2e21e02b14a75ef0ea855dd505e3a95f6fe22c4dad2dcd834048ea23c328aae83cd00f015061590e78f21e7b8e99b5352cbd815245bdb65da9dc2bea672e8aaa5fb4b0fb3834c09226e11e91f1ac9ffcf3dff39e7afa0eadfc8b1e3868746c2bad4711abdf00789103d544e2805ac05f00c6c4bfef770825ad25fcfe8e99d310bcaa7fbba4045044610c5256cfb1fd3c1d39da3122ed9b9e2bfb68dc139c3e72f00991e1c16557509c40126d82113301b9b8012a39880825f0815e94e587b0e7f287e3e5e95efa829445efd8a9d7221edbb56c8186ef4801077eb7c6576c423bde49ba2e2f1b19a164c740fbaffd8c3eb2eeb5da9360c72723bc1e8a580669fbb80ff67ec91cae0d870b269b2890173d11ef6a28127a7e71712c5aa15eebd787bf80e30b0c36446375a327b63c551a7ae20ffafeba162bc3d7d4a9b1a67502d24d42aa0bdb956a6fd4503a0aad4b0a51875170431cc0af803eec14b45b17d448959c8319cd9f2305701f54554f99aff9e1a7067a2ea47f4e912ec981559d2578c14fc9cf8966922dc3a1f72361f13de5f3f6c2bbbfcfe175ab2e036e12ebfd3ebbc6a57ca7e7e5dccfa7591cab7f8c375fcfe5838896bd69b4c32475eef82e22ffcfb8d159eacff31c4d65c49d9800f3e52e2f3f1e84ba9f8dc03c83ae8973cebee09d5c42a40ee4cd69f59817ddb390f9e010f270885dc7653630eeebc58959f87b9c134a9d827af5d656a7c21036d45203972286dd627184bfafaaf762b4bbf5ecdbed4203adbfb05095f26a4947ad3f16bd6a2afcbc5638a6b2e46268c2267ae7d85422a5bfe6663aee82917eacb7b4439ee26e9e85ae149fe687dd8395f8770e4ed6b0f494e15bb651caa3ca64804dfcf144ed2d087981b4132f960cac948ff590592e7ae7cef87c7f6a2168c69469f30f527178f76be860c472a3ba128100a1e40d1036b9457b1a7b0bfa350a70f0bd1e748df1f664d8ea41cfd662973f9d3d68e812d12851c5800919089722e97f26419c6105c3d5a17e0c5fe9c9b61b2fd683762d27b72feec1ca4f1ee94bf40751d180d030bcdd338fc468cd40b2c02cd1d271e08fbbdf597572cc9decbf0a60f89cd14807a180ff1c6c577cf7aa2a9f02c5288c6952badeb013400d4af56c5d5a7fc77a617c8766ba979662d9a8146e4d8fcb449f4a6ed4bb8fb9fcda1a3ddc39dab4d57cf9018cdb243c9c738877269ac1ea38071d77a15649edb0d8e2a3576c67b12d85156990fb98e53912ae2b873e313d2d833063605a10f91c51f968e5211b9002625935e3034ee2e5ee5aefaeecf39a8822230da1645d3623b8297b684462549f2b408ae374c253fa7c004bc8f25b40e927eaba8fb44c0691e76d608fe3bb1b783726b0fb5e85bbbd0d806e5afd3d838753962f997cc7696caffa7845475c6959b50809d20be25de29462c61f19c0f1e8b54b6031671bf3e64e977fbeb6fa0ed9c2d92f6b52f0e94e8fbcc6c8a00fc5eb1b4e25c17748a12d2a075d6dbfbce5742f096b99c100c777a7e766ffa3798b7e171fd38c00c7c560d016bab1cafa43eb288080b4c3a369d33c4f5e12a7c8d323aaf0027599449db81f1a6358c049d7ba91b5457cf05c9c6df17256c9b6a25d7e91f02ae0678522db7b251129b9151dcf27dc42a0f4ad535bcadf95a408dc2119eb8e9cab3afee87b428dda557858adc5dbd1d531421c763bdc4318a344d6033779bf4593345d295d67565d5e27de3ab19e491c2a731c06eaa0433d306ff39fab5c4e80c4bb8cbdc4701e595fa82db66635d0de948d14e2e6f49acc56fd4515c073a474bb20e841292b7d334b2ce613db042e62deeb3fef35ac7a23d9d0a30d12e6988d4852a1d88d1273cba031329950276dfc51175b5de4f791a57201259f9f1201e5a3bed502095c474b21a8edb7d35691a94f143592f7e0973599b699c4ada546b139ddc369c83829c30c0c80790d8f417fed26b63529e332331a25658f515b1294d7e0a4c2249092950cb9893927276175cc94976980c6ed205c689548d667398177f833a8f522470cba424f21f47efae734945087a71639dcb4879817103d3e2ed9acb128bb98faf7cf509253331b3009ad98dfacc3a2d0e5c078928ac5164dd3212c38ed3858f3ddf0c1cb2e623f2da6d8e5093ded853ce2afbf00fd3be37c1126dea88da9bd4eb7cc2881d3382abb97a39d57e7a9ba0531ef6e0c8db4bd8a3d6ca62f4e1ed4de48eed8c33065c274199b038bc06167f190749993d197b9ca08ca26741f0f65c44a618995a7dddc2dd4069d5c4178b3ca688c21b40e9ac1882b3845c1eda6ffe9ff53a3c2abe8e4e45bc8d20ad13324c9c5da05d0e720eb92ec1b835a0858091a7ae172370115321a2a3e28b9d442498e79e65476e146c378415367b6dc846c9e5096f154166702d8be4f3dedf0a5763e699557cc3bbbc5d3e359a302fb71f46f89826df44881fa9b715622d3d8facd7c88ab313823a3caf919956bbbc96589268bab21a3f6deb48eaf98777564b9f3b339782fab8925f0ee94e2082c2b169a430193a77a7742c6a798421df49f3eb43e9d6254dc09080da407ab3dc51609aa6914d207a7881d36cf5907c6168a895dc35be1f110286def813f7d78733cb382d4c9f48909ed8166198cddfbdebae3ab808bf4587b2664f8be1a9b6a0a1b0de0ebe1af60727481591f252ae56e774804eab6ac9fde49eedb823dfff12cb8e241fa9eaa91f1107d4ff5eced29e6d4bc9c22c0b3c244e8d60d7ccf07019a7cc99e2a3d0788a3123a6301c001b2bbf1f3f31d962249021b2274532dd2f1e759abed5f3b78fa6b05ba63dd935084f6293ba5b397415e44ca8627efdabf248dda0d311608c3d4226c370ab785ba978319d15ea3eca72ef4584228afba0a6508976b44bf4c3c68d2e8f1898e47d7e4fe90a2afbeab3d1f701a303ce63ea3d0750e70852aa43889478290651b4dec2cf10f42c5da4fd9ddc95ca30c7d66b948802ea30198100d18da755cf5f33544580df3e29a3c9be36142caf25a0e906f132e86a0634b3291ab9b20ada1d6b818912e7768c1f22387a58cfa57e9f286ebcc613cb4de1bd72a25c9e292a6209cc3e22a9eb24a28f11d54daabb0f7365e0260a3f7508387b8fad2b649a9bb4ab2c0bedcf06edac0adc90fdb7ed42ae39ff266c5e646263f9f360b7b15592955526b49523713e75e5a3f23d4e33d5aac7a14969f4d2d8bda25a1c6296cba094dbf392505d300c10a9c29beda890797ca093c5a9cae0cb67dd382c4d0450f34edbfca314b81cb538b949d65b0f56d081d6a0d54a86ccf9c608bb512d56b342ade3702fedcbad4ffbdac0c55e64a4adef7ca472baffa56ada8fa7ba78aae787e674ae3d064878fb1e47d3cab0657adf2d2215422a814993132164d9ae753311569ba99c211aa8e57e4023a0e2121a9ab30e4de7f90c08c02a7b7b5a51b1343d5b9fa38596d6671dcc17748ff34ab6bda61bbbefd67da94efa97c21bff119c582e729faaa71d7cf318f2750be7832253d8f2eddbdeefca09c7d8c89a4a314891e9a5a75fc35a04699d62dee12ad223495a5cc579ccc3c9923da1a6a567da38261b5a01d91bb58ee4560839f509d0bad88a3f96f90592fa36ff8096b388e94ed93bda28b304b35afee9ce9a215bc9fa2ad863250398966abbadd7d5dadea34c69c30c16e669f1e24aa7fcdd58cc680ad789e91ae7c00bd371377ea1911e0262865a2f7156c342c664dfede56438bfdeeac44045f93277330d0f024455c9c33f1adc5f4da8151e98b7e776e6f7f47688f8aa6641be84f652f1e10a9ffe0beb85c90b7dfbb6e29b8be50de0262f1b15967dbb513cdd6f039dc0af86651fca5b9c3b24f4b7e51daa50020e34b78a4c38aff4b5c6cd109deb30d2f10fab0750c6c01b25ccaf6dd70ba897ec3dd0707b707d8fb74f5c4e25f9c96e36a9b41c25624b9aea9bb5b30524a34897d6c0979ada558900c46b12fb1f7b5039f0456aa75b9535108130ba66a9f9f3a1d4f491976e4f637b2619c3727bfbb3c987383cc1108c83ebf6b8c191aade3c0f6bae81558799f944ba9fe29fe1a3f3a60d76255257c331a3d5928067d43cee8140e3f92be77dd51867935df194be1652c9397a103dc32fce32041896fff0510faba599b858fd755ae4f62c886f2cb26262591c0bab5b6e1b3fdf81ce7c453cf59021020cc3865c4454b10c8637cb816b4cba9706d4be54b8dd836db651bd79c2c2105154922fe3550889de6ccc9f527a0b358882c6926cb15e386a44684af2974b8df1a7087e4e80ae8c80fd90c5c4ddd333bad1121c4dd87d48f25d80bdccedd439b1dd26130e0719165f615aef078062f014598df1ce5a3cc861f7434021775e52e6a282c8f6e3042051dea66b511f45c84b9abcda68d102bf8bed9d5de2f817a3062972e32937260d8dd6c636aa289c6ee679b24d2895e8ef8b1b4f3dc90d52a54dce30889956bbbc225523abb4395d8fc3a17149c18acd7dd89364bc178eac2816c0f476ea52d51c263c4ff745d7931898492ca0aa42a509154658424d49b8a4168a3dd722af6b2fc000984222285ca4f65c5908e3951417f74cef687d950e86b5e768361e1985bef9d61ee3a5719b119d268e03c06c50d2ecaa95d60eaf77b5fff0d6b0042a9be2c47378b70f97f191d2ebded6aad2c901aa996074a79283333d2036cf79c15357444722968d3f250e295818d8b6835ef7fb13c5412b8b1b4c59a6b01a45058fd716120ccdbc44ea8b5fba1f99c555bba7cc71f8cef310fbb0c95b54ece1a12cc8d1abb3b4119ca23df38116aee9fb50776da0bc2ba3ad2ee575a9e759a43d2af4512bfaacb9d19a675f09cdcdfcfda37153df3d0c163eb4d986c7b81d6174d16d2baa828859bb7af751fde32d9ea10e3bcaa983549b8eec4f24e12184ed76e3c5d33ba4dd0d06386e84c059a04c7e189dc9b152147ade1ed8bb41a5468aa2d16abeb08a4c4b1c5cdf805f239450ee2b2a6b9cb73640d459380f703032ae9fd258542fd49849b5a71b83ab5bd1407e60f80696afc800a2e53957245bcf0fb618348025bb7fe872f8ad11d249a8bdf807b62511535a1df87d0be718b4ac1c4778019bdf06f0d1070c98ce713c986f6c25e7eda293d7832d1239f8f022d39ff1172503a98d4d40a2ad87272ec6b29f60acf8adc28dc3ab2be27c7708ba9a8e9652cb2385a9a492c08128488a5b399b8fc77c1d204ce0d9ea1edcf18618bb9d5ebfa382c5d62c0542c3e46cc2a7e285af14f9b2b42d63531619396e8d7d25b7a12b851b3ebee22c86e5783fee1346ceb54f7143bf370a066601e19035f2182f2cf3be72abbf23b9fe41f1d23810d84836e5c22d1d5b2f282061e9e29dc8731cd24e6bddd536b16a4b2556838ff29c32cdc1f799798cdb9be33b08ccdc4dff6946b3d8400f153a0f58b148d3aa2f31b7e815a0c2d670c73e26042fbfee6f6ea827619acb99a9b6a7939e96691372a92a69ba136e41d5217a8b78f28eb8707e593005b08f6c0546f1811146428781dbb77144c65b617bcb3afabf40283d1329487399364d6efcc6fead6eb1bbbfde2ed9b4edf9ff7fa5772cae1469b247787c7822cd8522c242e5fc2f19f3771bc5222a1160e9e00b2b8f6fe9694a595dec255c49a81429cb47a1681cf0efaf793cb197911e88e6f507e1aa0a0f9872c273249004ef62f0edfe731] */