/**
 * @author Merrick
 * @name chatgpt
 * @origin xmo
 * @version 1.1.5
 * @description ChatGpt聊天，适配无界3.0
 * @team xmo
 * @rule ^(aichatgpt|aidraw) ([\s\S]+)$
 * @rule ^(aichatgpt)$
 * @admin false
 * @public true
 * @priority 99999
 * @classification ["插件"]
 * @disable false
 * @systemVersion >=:3.0.0
 * @authentication true
 */

/* 
基于sumuen大佬的插件修改，主要是适配了2.0界面，按自己的使用习惯进行了一些调整，原插件在这里https://github.com/sumuen/Bncr_plugin/blob/main/Bncr_ChatGPT.js
需要ApiKey，没有的可以看看这个项目https://github.com/aurora-develop/aurora

v1.0.1 修复了QQ和微信平台在编辑模式下不能正常回复的bug
v1.0.2 跟进大佬修改了调用chatgpt模块，用got发送请求（虽然我不懂但是我会复制粘贴）
v1.0.3 因为前期搭建的项目有问题，调试的时候找不到原因，干脆把代码重新梳理了一遍，具体改动如下：
       1. 修改api的调用方式，采用ChatGPT API官方文档里的方式调用，去除了原作者大量的错误处理代码，大幅度精简了代码
       2. 添加画图功能，设定需要单独配置画图的各项参数，方便用户的不同需求
       3. 修改HumanTG的编辑回复功能，可以支持各种回复类型（前提是适配器支持）
       注意：这个版本最主要是加入了画图功能，如果不需要画图也可以不更新，因为新的调用方式我没有深入测试，不确定比原作者的got方式更好，更新的话需要同步更新prompts.json文件
v1.0.4 适配无界3.0      

todo（其实是我想做不会做，大佬带我~~~~~）
1.用更优雅的方式实现HumanTG的编辑回复和直接回复的切换
2.选择预设角色的时候可以把Prompt直接显示出来，方便调整（下拉列表框和文本框联动）
3.添加画图功能（大佬的代码已经实现了，我没有4.0的ApiKey，无法测试）✔
*/

/** Code Encryption Block[be188605b2af9d5e9f0e7db22a9634fc212a7ad0a1e72494f09b567ed405599e3a6969c7bfc1217e57a59f2120e0f9542850a3d41954a72effbd7a1d5c4eab4bf188beb4f3e3dbec38f4ae588c4f37080b06085c349e7e725519765f0d138b461a28ed42fe7e883b0eb70234cde01738624108424084077d17630ced0cb199a8171e6aaf17cf64933c3ef4c8b1e11daadde35f592c013bf37ee4537a95dd3a7c2b22416cf55052d6073c6cc14edab78009a388351d452c06f44272ae84fb6586c8ed5b4667bf2859ed80006e6f9917c97962b44b4a62fa01dddef3e2a2930d71e9755cb394163dcf128776391432d9525a7969cd380d0c6d88bae4bbbee3038b10122f82953c1c9fa62366e3c1d6170f2ced4177eaec63c5a149e730c86b5de4f29c2a714d0d11abe211c90d954904b82551d27a18b3fde5e9fbb601e53835a0097e3169f1925726c1cb16b835c2e3f83ac46f82b1297bf9c9aa3d0fa10cd692ef82c6d3cb9cf4b0d8464b60387e98bf98b25fb58efbe0cd3c1f810472f4c82b2e79c1ca9a8d7c3c90ce8b30af216434185db87dcb0226a72e91ffbfa3f1b28e4459620794e7d1f78ab736f2a3d7b7f97ebb63f4df3f73695bf38bba3b69756a2e864153d714dcdc4f230933fd7c59e47352985261d0bb6101de13b26837454717a7587cc8ee48a2b976afd5b2606f6a705f30f95cd5f839c70f702a535369c59f545a1fca436fa60bffb794df163c99e124886d697dde2d527dc2b3172741bcec6503fc3bde2a84dee51bb70c68ec1a515eda855e2a631b5fad731adba9d3db5537829d74718ba0a39b1a9b4c7c0ac99fd8837e3a98556bffd0bf16d0e0dac10e5975c8d50d6a547d890823fa457d122b2e4a48e30d07ed41ece2c51925ff8197b70f92ddb8e934bd32bb201778d6461d05a0d0e4dd2d688c55e8ff20f7e65ddbd04bd8c28ae4e8d37387e68124aaf37b4bbea327c2748057454653b6c2a6654b93cd59c0eabc262fa15ab837469601ca72cb8f9457ae8862532efca4471869ecb88cc1148369d1699f8e75495be364bba4b49d735846753b946134a092c2a02a8d0e555a40de6c524451543308f3eb1265689049370845e61fa737676ad7ad14577dba1223236055dc61e1965836ce28e2c6d5f03fec62f2c8c420016ae1e98a98ade992fe2c65bfdc5d49318af251d02fc4e25e3249236d9c5db74e380e264033687a18fbeed990f5ab1e90f41338d41a31a611b375f3a07bcc449e61ab912494615b65f8b8b4b5ff63e61b14befe3bb463cb8deb9026252df9391e9ce7920c7f112ce4d46c5e5a7faca181b982c2491787360a5b5acbc2f08f140188ed82fa805edd8563a40ff9f7e7665ece10f18d0f90e8df9f8044665ddf00345da543ee300f130384b642fdf3e3c3506d6b2b8a385d9edbbcd216c6e02cc5abb4b0b7625663a2acc2db5c74e55b1e6c6721569fc17532db8bfa5d4f531333ebf89c8be9a62c0c4a59126a6082e98e36d98e276d57e286ec5ffb64abca3fb01e81bd8b8df9a077372206f1a7ca2bb9b1bcb47e16ac7f935a32c5be7e82cf92c8169e6513b3ba8c7db2bf546029a92698214d4636d122791c739ac46d9441f4fc6c2a4a54a8e31ddefca7899d007609a330f53dfc717986274df26fdbad32edcebe21f4ade8dc48cf1bdcc6750a625e851305679632c675068325c9e4c3c45887cdfaa350ab9b9e4a0911a0c93b3b449148d2e9a130e36b61b2263ba1b4a0dabca3a3feae7e22e7975980b4a2cf41c6e39db2940deec26ac7adecc89c0c87e6eb07e8222cad94e0ac70b606f179c354ed525bcf64dcc006b3b4b35862287e03c179905fa5dc72b6c29ce8d687ad4cddc72aad6b9fa424956299757d9a7a88ad9597a62d999231c95902b8a4cf865b725f8243160b8a5e5ebdbf68a0d14fdfcb9480453750a7b2292b57fd142a9fe0612acafa5828cbb73c9fb44616a47806256867f577d5e7ef2b721cbacfe2d1a4536775d65bd004e071a9785686e69621ca94aeb80b7c4c495e6011f7c673a37d537e3a2f06bdb2a986dab34645430873f87ed267b06ba3d41152210691064356d04e53a247280781cf8dc0f74155542d8fad4c14e2934ef79b00acd14d357c0fcd1771ec63744cd842c5ae5154b4d17ccad085c3d6a103b68778ac990441644a0b54388672416c159891a3475fa55d8ca56dccb05fd0ba293d8ce22253b94a684860d9562f28e76d0ca81113c927b8eca5e3531040abeb15eaae8452e8d09c0b3021e779f36fa4bb54af95e8d28b91920cb93bfb765dca8fdfe30e36d93fe16d0a4f002884dbdf1736783221cb2d121bd3d15290f33879cd8c2c9111af04b82187baed00543cbfa52b6ecfda68cbe26663ec7eb39ed2c4aa350475e045eabc1140360ca2dc3c81b4f58f86c2388dbe921d821aae3bbc0fb57caeeb892a269b2d6731a7d35e993ec03c8d092947f3903cf12c954fd2edf702a8e325ae2783aeaf12b0187edbaf7b2429fc2f036a1120c7224bc85c0d0db1c7bbacdc673da9914d75c9e798d5d8c638d4d4478ae929a1a1d979733841cd2f37ba1e56fc8613604a3a9a4f9a1be2c3b08b9cc020a0bf8f83f6bd18040b345ec526ddeed97923c317c996acba9c2ecfde317b845bfa16127eac6e65f7297d782c7abbaaf62d1683eb0cc0ced81729698ccfa93e6cbd726bcc74209e60b021aec5b90c80de936fa3308e6ac47ea1dc14e922a6cbac6f909cba483e7783acb34165bec3500f78d64c5b54db38b5aa48f725c16e442908a7086e8a2d041acba47ae9546f5e78d2b5099e83ef579c607c2d46768f90054c91117ff3ca76ef1cb75626d10263b0ea85823249bce08ce439a03068dfeb0e0cef1ac176e00ad3e37a48559167ce99aa6851f912cb81c2c510b83ff9be183dc8527e0df7fda4ef11f188cfb82f32f34be3031dcf0d44b16514a1a5b514f41a4ec8858a3da6115ec35308550eab30a0ca1a1dbbaf18a0c86b952fb1a363ea42b7820d18e297e449b0893b4e59136b0158b11ce6f50cfabdba0df38a3a13c438051c5e6a0f0373b0807232f561da6cf863dad7c2f912d0701c5e87a3bf1c1c143736bede45762ba744dacecd66910862ec0ce0d73536cd7b85f1c046549c7aa868e9b5433235bb3d2dcfbe03df4e0b0038dfcbd8304fe6a1a2f6497e52e444b1266af715e75087d4f1872d0199d0091f0f600c891b59b74b52695502bb26cc607ce85b02800b8d29aedbf3c8dc0cb64d7660a153ef7aeae93168c06c2bce50dfe25e180f35763d57986955d8247a75887a7efbed6392254ce4002397e2121a596de3b45fd4bc449d5636dc12dea1e661ac026ed68bf8af7c651a7f819f44fa0eb3c5258c785451e7e2ab1cb0389f8c0cd3e4fbd16de0717e4652fdcdb3bb26bc537d527181f5fb58e4410ff8da11876b51a3fa79efc768f1c040e10028de56143aba537f8a81d30ae5a2ab0fd3d7bcd40d92d06cbb7c6ae17f2dfc209062f6a976fb6859befd0c81fc28ef7264fbaa9c11d1d21335094606c5a780c71e6684ad866b41f2c8fd9b0b7bfc7902c7545ac5ba050f71b13743042b485c79bd7268e929c4e35b43efcfe0e6d11a17fdd90f44e4b5631322f8db666e38487323ec6177edf9d03944b8a9890c0e5279c77a96ff514fc12b92b510db7411480fd661e1ed7dd011e49922d9a05586ede87ca04c47abab27822c5fdd12732e3550a4cd3b89b1aec45bf4360967cc9057c5dd9a38a3fa1a7945f3fe0762dcadf1995691108d928937a10f103ae4ad411ab25e6fa28bc1e179e631ecc1888fc303930599dbee6b69c0dee754125c84ffc8e52171f5997683f57236d1b5d604bbc26e1bb5b0ec4d1b2728a83fbd28f37632f86b660c8920cbd1bd4d70f7910e29eaeefbeb1c1f89dfdc12f1e77195bb3c7acaedf979d792b25d69713596d9168a4928c3e3e51f2ccf64bd2aff62b28d19a5f02df2a05f6a40fee9b662b293b798ea8550650243fcbdf9141ea10fac6a836fbb8aaf116a4f889301161523efee99702fa039d4fe58dd3f9f892de38977b6453ffcdb315fbe0f3494bcb1051e587d8e60521b662972613fba115dd83de90254216f89af708e20d50d617046f4a365a928c2bce4baf3f9282c27119c4ddf3c5fb895dd1ee9004959fe020d16fc8675afb245bbd57e9e276e8eae9558048ccf79981abefe95ea1592d38f6693d40c5dba2d0fc81eccb8026a779e7d99d4d1417430301c01538d1155ef4018ebc0141502b8a63aa2c53187bc60097838f750bf09fbdddf93ede4cf6becde71d5dfe3ac134027555b1f82c656f9ff8877aabce23ceddc18b967ff8471c736065ad3b784212b1ad83c66e7460527b8bfd7713f20ab22e3ccbd35bfa064048e7380e99dc0acc28206faa30c0515a4824347f60007d68b8ee98ecc13beb9f28205859a6753c654f8d52a09e7e71b4f8c91a4a918b854793fc93b96ed9e47282a9d725149f91e92be84568864a16655ad43fd6ce5b14733faa85a1ada0f92cc6d9b195d4073b82e5d078b821a6014be9599ba8755842d916c20b8fcea60a234b5814cd843ffb4aef35f3c22c981091aafe525496b863084ac1697f77fdcfd56faefffd9223114a17dea67e5ae62f0d6ecc0354905156e5a3ce028f230c3ef4494ad3398d779d0daa94384ef0acb0010d56dd12c9c01fcc9a7224dddd5bde2c4941ff9f45553f76b90d833dab7e263b827f6a1115eb148672c8672e8e5360a84944adbfb54ac037bf717f606fca6e5da1f03887c53aa877fe9b6c2d7f226f8fa4e78de369fb6a4135c8f079ad579c166c0cf518c3c295351f2afd9c1877371076a5ad14163d9cdeb0a97792d9ae89f9be2fe0b1316723432db7f63f6e89e2900b604dc72055b9913a61c87501565f9706109416ad330cd5ab6ab5b778360eb69336904d5a2f5279d4a6fb0ef80e991ca260e647f7102e3a4ede05fa951b9be7a6e002481e245fa63deef3d17e3b68092963913a24ac23c979913297b1febaec63af89d2d5ec12b6852b13dfbccd68bed5b64648053ad201bdd0001757ed3ecb090b77a425d369d87a8912e88a41a8a96c577181ddb98a0ff081535847ea7ce60d4aa77b99ee5a427f9d16639270a5408329cd076263752e6e46fbd0b033d3c63df1000a6bec0856e21cac11699ccb4f3b1fd3d0c86330045824615943ce679a2e59127a2d0573e5bcc92fac2cc49197e7c8b72e3e180e65909ca5390d75571a5b4835174c6accda7ef216057c136253c39725242556d293d97899b783a4f408fec87b3c638f8a47f634c1126c9cca9223e1ca3c87af8715c4e82dedc044b984e64693cee055c609e49e95a6a95312a73e20a5dae9d55c5c4256cf01a3ce85e166f753cfcd757546d48f2882feeec72cd2bdf9ef71738c8015ea11b6f4ad34211f3e4ca0afb415c8e4a963b828a21dd30e06fcd20c83ecaf5569ceb4bffc08184e0adeaf6d15b0a2fcfcf8c4251091b81e7b9b90b523003169567272951e02ac5df7134bff393c7d3bb854e37455c7a709be7e73faf59b3bfcfa0b33348d7524be19a4d9ff53cdbe8d1b4a0f940c7eb10e4d47453f41269ee9461ec777e05e840f8fdcf0b2fcea4bc146e527a197dbf32634d505b3c3af0e84b6df9b0488edd2ff2c843c04bfded89a090857c909eef7cad52318a31a867f8e4d3e16f36f9ce4012bad5a8d1fe7957c0d04196ce4643d3a43823805a062a090cddb9744593d6ef21e15c028ed14a6d3e25cb2c498c6f648397390fa9a4b2ea7117d6867729d747e110830dd4414a99c4e99f4747b48f17b9aca7d51f879d5e14ba8b218329c6ac2213ff65af11918c3e56d98f4558b77e1acfa3866369eea928e9a0bed774ae729dfc75cac24ced9c3db5efd7bb7df11c6123485b102892df25b23f1700ae21d4c56718fee303eb9275bba3d0a3c8b5e656e7682df9382aa4d1fd6b62313fb68ec0c95b2e9501bd89029ce88d7ad39165cdb455a48c167d9965a444f71caafa2fa6be7cc62b1d95388d35c2f914918878e0f52f012f92782f04e56a5f93b06a9fc0f5159def4814f935116d01bc3f4cd5655664e44cc48f1154d9081e128f9ae3692945330e5de305c85b687e365a912ab5e455b75dda92ddff3bc66fa000a8d670f949707f1a38857f42e29138f9821df4485ffed6a741f7422d5e1d16baa5f354977e8808a4c053915fda9318159796994e005f1ab5ac4cddd8af5c18e420afbfeef51f4bcbb6a29ba90047d2f10eaa2e8098b7bdddf0d18b09e49a777fff9444284349f4ccf07c21f80667edcbd53fb51370b3013c2c880e1f8aad7332281b360d4d16a1aba15c72f417233925cf86af9d5f5666fc7b2aba98773129fa780a019d5fd5bc88dbf871ab44e0db4e473d6bbf312a7b0e42a2d2e91303791ead70c1bacdfa52c84e2dae4ba3e0a04aa4dea4f888e98397a50f6273155b77fb001faffab8aeffc5c104250b885ef20a6cec213d47d4f5d41d6e35f236ec7bfcdabc7be5bec4c9eab1ec3da17f66a3bec062c6214a062e734bd24b6a2d0fb86127024349ef216dbab0255021e650c81f59f851fa4d868cde063971a2e6e2ea4552c250a91c2e83087213b47a233b39def158958022efc9ed3d7e9d046219ac1f58498485c467895e9252de790fd3c80bebcca5686fe4cc694d789ff30b33fadcde852feef36ca29a85f853427dfe1905082459082698489b8f3c944164893c3126549d1220c1bceaaf28a00aaf574ea5a30df2dff7b9150b70c08c78c6809ac47f13ac0a1c5b1aa925b10ef8769fe823dd49a5947795c93d5d8068bf81af633405aae072f04635ae366b120aab4b045462820f427dafb995569e4f874eee7976d2b3a76c0ef8a0b30577002f23c2f630a1abe45549a868bdaf546f09d6e417b26e347feb7d8981c4b82a910ce5a40c0d4adfc23d267f7e2bddff8218a4e85a1dd4e63bb0290b1b6b7ce5c0aaae5b7593b4ab0a0d0bc8607f0f101eba07572981118d079dee01dceaac0488ed7a2d876d1666d8a5857566920ad9e2a18cdcb2bfd8ebfee43d18e2069d0f8f51b8de6a5042c6ce41c67fc3c9d2e44df94756d70f70b88c6ace6940acd5f294eaa8b6a489017a6fee2ed09b6bb73b590634a6ba869103a74113d57f649f17e0c790cbeb1088091facfa85af7c33c2b95694a9111971fc39b1415d4308d3fb0372f2bb6b59e8df4668e0f906807cc8e8e2de7d43a88adb6101b851c4ab16eb8934edd340b78a5602d1cfa4d849e62b2ee07d778b6bf3955f3655e89695ba39ab6726793eec2b026b4bf3c0a0eb69fb61adbe03af6b88dc429e3e2e4403c149edbcbb3cbcb8ba932047d613a8894803e6ced2fb1542c51f7f0afc47e753f4b8cf6b440696e17f05c286d91ead607b77603d23104daec3d1c3c94ad9f51d6efec26cc59b0eae531bd2621eede686d322d08e1db126e656df4740a8a838e80794b1f96049eefda41213fe41cd84c7ca37df37ca4561d8dfef525f60a408d5d5e152d55c4635f12a8f0f441a3f2c0d4f454e7aa541abc58dba73194bef11db32ed5166768098e1d32d3f4079994980ffc988474a371530d9f7a404115fbdcba64adc2b84c24e40a8724dba0d35e6c42d08c9f6f5382a20916f4715ba67aa12286d8e575c22674b93e921b45ac7339eea934391e1f414a4cfa279f85673d9e578b525a7b61d225f07d96268b070ffa4343842964ae97613c5148197307e194269dde5e912899ce6d6fe0998d132c34c3a157afff2377c5d593621c8fafe97cf5776d0e84ece14f43f1c98cf4036133310e74faf41f54dbca555cadd7313e7759ec226d0bd982b02303482b3932d250904a77a27c0d5e5f6dc73f0a00ab11c4980a87355066813718fe9fe087e2e8c3576d09ce238d0ec1d6ae29223f1ec7cb5a2e5db26b414c58282112e46e51fcda7e6f2fa00da8131aae59bb994efe7c91f525e2da49cbc4371bce54b8222a28446fc821d78be94cd47bbd07d510fcf1f6936ebe8cfecdf6ff4c1c9b3a9bc50bee7dbc7688c63aeae77cbe15bd15c62cb02581a1bb6725d8031c085eee729c1b4b075f445fd43c5e3be2a0a6f360812063a1e7995fc0d7be69a7fca43595a1686a27bbace777ac0eb1c194346f00d94a44bd889c1f0cc9cd2788a53ff1eb9f8c35ec6d67c5a42a4069641abe46579d178b190171f3712c737643a05be3b8ecafa29dc1d558281b78d5617a869cf3a5ced9af64f17d7c66d27de72724bafc37c56833d91079d0e19ed1d55fa2734f6c7df9731fdd6e00f5e8ecaba92605496b374f375695cf76729a41880e3f614f1071bf33180e19c6f9813c451619cc359314eaa20dc8fa5ec1dde62dc4b253e5cfca7b66956b55985bf4282c12deb470e4bc6aebc233a31d1e46020486c130fe72a8b88e2039a874812987a72ff9ff721684bf2d7b829ce9065cd18ae82093ca1d204a5686c429d140ebd2384d84f0f666cb1e6ffbe42bf04fa49dba45ce8969f1a3afba7802314109c0c2252db2110b6feafcd27947b46099f6a9e5e514e2f9814e4d7a911f886aa1c280011d6e7a852040e4c3e91c06d40fa8db69a443288466176f8add46228bab8d91d80136356b4727d80652c88e7af7195ec2960150a75ced1019d5fde115f6a739dc27611e9603f5a0a02712634e42cb62e20e493a66be7f2b86cfdc085924b6852d4ed96bfd26918f91831b8eab942063fbe0dc5d372312789450ab11ce3e916d047f8b7cd4765db2ee8f384e2d64488ef67b3e25e00ff72a4d5724a190034be47882601478043feb0bab1debb7b98a631520b34b043c0b2522f09ad5002970370af9554740177737c2013e0889741a13115a2de5004fa6ad9e2886277822dfa0781a1a35cbf9ac38e70c129b276d1a17b80954487da66ba86d653c7225cf424f87c05490d2be3f872b837c48f3a5a78e6bc3899b1267bfdc9dcab8da95107d135067e2a70e9a1fe6a35a8f96b2d1afc1ecf05f4875047d43f8abe25318423aa07804f5d86a961a36f70a61aa51e2e12083e63dd7f1733bd683a9a5b412a630e5a991c9e0c6e42a5fb53a9bbaad6361c2112f3002a2f157a] */