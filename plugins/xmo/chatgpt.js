/**
 * @author Merrick
 * @name chatgpt
 * @origin xmo
 * @version 1.1.7
 * @description ChatGpt聊天，适配无界3.0
 * @team xmo
 * @rule ^(aichatgpt|aidraw) ([\s\S]+)$
 * @rule ^(aichatgpt)$
 * @admin false
 * @public true
 * @priority 99999
 * @classification ["插件"]
 * @disable false
 * @systemVersion >=:3.0.0
 * @authentication true
 */

/* 
基于sumuen大佬的插件修改，主要是适配了2.0界面，按自己的使用习惯进行了一些调整，原插件在这里https://github.com/sumuen/Bncr_plugin/blob/main/Bncr_ChatGPT.js
需要ApiKey，没有的可以看看这个项目https://github.com/aurora-develop/aurora

v1.0.1 修复了QQ和微信平台在编辑模式下不能正常回复的bug
v1.0.2 跟进大佬修改了调用chatgpt模块，用got发送请求（虽然我不懂但是我会复制粘贴）
v1.0.3 因为前期搭建的项目有问题，调试的时候找不到原因，干脆把代码重新梳理了一遍，具体改动如下：
       1. 修改api的调用方式，采用ChatGPT API官方文档里的方式调用，去除了原作者大量的错误处理代码，大幅度精简了代码
       2. 添加画图功能，设定需要单独配置画图的各项参数，方便用户的不同需求
       3. 修改HumanTG的编辑回复功能，可以支持各种回复类型（前提是适配器支持）
       注意：这个版本最主要是加入了画图功能，如果不需要画图也可以不更新，因为新的调用方式我没有深入测试，不确定比原作者的got方式更好，更新的话需要同步更新prompts.json文件
v1.0.4 适配无界3.0      

todo（其实是我想做不会做，大佬带我~~~~~）
1.用更优雅的方式实现HumanTG的编辑回复和直接回复的切换
2.选择预设角色的时候可以把Prompt直接显示出来，方便调整（下拉列表框和文本框联动）
3.添加画图功能（大佬的代码已经实现了，我没有4.0的ApiKey，无法测试）✔
*/

/** Code Encryption Block[be188605b2af9d5e9f0e7db22a9634fc212a7ad0a1e72494f09b567ed405599e3a6969c7bfc1217e57a59f2120e0f9542850a3d41954a72effbd7a1d5c4eab4bf188beb4f3e3dbec38f4ae588c4f37080b06085c349e7e725519765f0d138b461a28ed42fe7e883b0eb70234cde01738624108424084077d17630ced0cb199a8171e6aaf17cf64933c3ef4c8b1e11daadde35f592c013bf37ee4537a95dd3a7c2b22416cf55052d6073c6cc14edab78009a388351d452c06f44272ae84fb6586c8ed5b4667bf2859ed80006e6f9917c97962b44b4a62fa01dddef3e2a2930d71e9755cb394163dcf128776391432d9525a7969cd380d0c6d88bae4bbbee3038b10122f82953c1c9fa62366e3c1d6170f2ced4177eaec63c5a149e730c86b5de4f29c2a714d0d11abe211c90d954904b82551d27a18b3fde5e9fbb601e53835a0097e3169f1925726c1cb16b835c2e3f83ac46f82b1297bf9c9aa3d0fa10cd692ef82c6d3cb9cf4b0d8464b60387e98bf98b25fb58efbe0cd3c1f810472f4c82b2e79c1ca9a8d7c3c90ce8b30af216434185db87dcb0226a72e91ffbfa3f1b28e4459620794e7d1f78ab736f2a3d7b7f9211e65502fbe59ab72b2b74b121648eac744182b876e6260875b24445f9f6a8cbbc4c9f1af4e1041e3a53643fa9baf97a3e17b3c60b91ccacd3c1162163a15d69923c6bded45258971353c3608d10bb638fda2f26623e9149b22c640580464555872331f70a5248f0b11b9e034b2f09d3bd55bb2f89c345fed47288f6e9029f0e653bcb2145326353cae3898545f3cdedf38bf0b3d3f1d21e0c51f85a0e0aea30a2cc3f253e52b8965977d48bb7dd957f91c8ad68b8ff993445a1dd216305a3b411580a21ed1d590403db80463b776a0527067f93bafaef7679572f32ab4f40aa85179cadbbf4a30a866c165fff6d7fdb6818800b3d2f846015fc5615fbddf8d1a30cd1a18f3b84087d6fc8a0bf519dd1b3065a6eef5f10ad0a352f84facaf4db8044d29efeafca7966ac22833cf114e6bad5b80386346d8455e641454197f3afcb754482c4b498c4cc3762ed81a67afe1cab900b88bb1dd3f391bf6cb65e09f6e66df28e2a840b3a47ca7cc8d43917b81509e390374a5f25e889586cbbb88a7fadf4ed594b1c0ea5ebcd87679a21b33af854266a59e848a87abbc96fb92a4588101142d9e4ef58a519a4bc0e5dd3b62ae858e04a7a382582cba11277cf3e12d72515cc2c6a47ccba5179ecfe47b5000b0a166a556d62b31f0438c364f70d98b6c51d9937d0299605a28709c29eecd5acde42e2bc7dbede6dae82e3a1657630283023bf40d1f7a4f30e2bdc0a55647f279be4a9f50f5d571bd2a45694a49c6f43d7d1f500f53b50206902a77c9e4dca2bf8beb77b10f335d4661a416b4b882903920250cf3d60abb2a7fbb600c89025d8ab4528a82f4a7c14232a7f281761839932cdd859fc7bf67692d9ea2fbf298d1a1de6dae0ba763ab1d536c463162f08e5dc344a379b67065906d07db092d9851ebd6fbbf16f21ea72ed91319ff58296b25d14ab7aefc215b52ac8b0fe91eb14a6e5576aaeb02c916ff897c4a1c901b566f274e9546a2f54bbacd60d43f951b77bb272cf625c0e4b11512c1cda4dad93b8e8b6bf7ad7689a39f6f50d42059634366cfc58399d8a419f9808266d2d43eac148494946c78dea61837aaf5c20e40d2bf7eb72bfd5498dba46cbed7ca66a0cebc18c087c6c1a91e214a4d4b26d07024f3f3fed10f25f8a10d1ea116ce50fc95cf7f9b950a7df18cb0f64bebdce7ed3cd3fbb5e774f4ae47c5a60cbc63dfdb63df3087afad522eda7f8d70032ce36ab89ffe28d96fff02be1cb5bb0470de401f7197773d321534a639b1271552fc1af57cf3f2beef821eff5d92db75c1ce23a383a8d8523c6d8b73316ca79089572d7f6bf23e5b5498ebb096605f4b9ef69122e54f15a5e61b90b917e9e920d22232db554f37141cc2cba81e86eeeee06e707a47e815dc3b9214b4289f2a73abfc6cc34e874e317b728afde388db82c395cdf28f80c3ef756fbb335ccaedd590fe43f8a20e170271a172497eb8624c2c2fc6108babdb87c5746e321e484dc9e844cf56bc8331391326452de907557e411517f7edb5b94f8a34fc5bd3394cc9516c3c11b41d7ff8a761b9e47bcce8947aa957d0a321e30b5c0f9015eff69e1a157216345f81ec83de87a672c2577d44b7dbb30462adfb8ce6de928f129aaf0d29c221653beb4698770edfe543db9a9ce07b84877139a56ea718895d69412af310a3357d06bab6a266f13e4fbacc29e4d15501bcf0801be504bb4fc2c137172b2cb9dd57fff0a66192c5b3df233812c3eaac979ea9ffc4c0a3bbfe65b37370acc7b434146e0e178193239a861aa7b883bf543447872cdf20eb067b5d506a10721725ff918c0b40e4ddf2853a6266121013535b4cafab48adbe98df0f7a87feb8b0c2e3474bffdb54e5fc841e8f22127dfe347fb35d449f69b8a62c883d244516673b2845c43835eb30b6232a51113e2a19f5ecc7a5b269d289c6f0f43045293ea674a85bbcf58a152b5bcfb959ef9e6dc7b1012a2650eafef8cb0b98c04cc15cbf7fea64a4498a5a3b7ff2d25b514408c54dbbfad2023eb841225eb08d0fa4b7ee1e4087b541123cbed08f976591de93a8fd0b635b39aa3428390c105f8f941ce6563b95de687da0084702b3a6367e762e9638af85699fae44227aa851ae28459d6f2936b1c3c1a3b455c6e24d8f9ddd5a11e39f4a8dbac4e1a0e230b3ad06f5c3123e328c58b46eaccda87b8982792747e1754cd8940569010d194658a43093f929d90f0117d6e6b334d0cf3caea00f9c3faa572cc61cbfb8b8f441494a446d0539216863af66aa0673e9b92e85f330e8930b9fc953da877bd855b5ca2b6727945752cd2a49167f889af02b2bc6e308484d47743f80db9c7aa445175afb8b1b4a04402c38bdc3190f1fb70bc93bd51e5742703736921bf8f89fa277e5b399f80f833b476318fad329bb2705b1462c89fb3a04f36c3e857261ff99a70c507bfd1eacccd66e2ace172960aff0a11957c2f1aa1af1032d9eef8e99a990356c01ab296a3e0fec09bd491c3eedf993fcb5a7ac167f6f4f11760da41aa8f066094e7c0afc2d3f7fc70aa254c3713d6f38eabcdf65ee4b76c4d1d2ff165a1776179390cc1c3d5845d907804ce70f969d745c9f82edccf20e6b03ab77241215f6105dadfb2ad59773c6839b3c27cfa7c4de1bafb8aace84e702098ee45c39152f12cf3fb2df5f474dd95637ebff84fca729dce3cf99d106b10594841d44638270019c78d535c2a281a6ede83978fd7ef14d474b3a18a9c96b41a0e25ab343c73ac696d8515a57ebcf83f4b6d59e0b572d07811ebc16fc216e54c249dcc27b6cf97bfdb8ff2c820589dc5ba4ff5ced15383bbc4597781dfddd3ca3b829a6005f8721bd15091c6c3e7e014644161fd468140a24c584688dc97d82ccd456dbc1d48adc29540494f7aacc58bffefbb63f484b8a4c3cb4e087e39120013a5e6daf32c4e1f826fccf2106db31c136530c8a07ddd8219d4866c4493acdd86ba8d0544c66a8d081a0d772a1666b84c71ea41f04fcddcd504284908ed011d1b3d5c5716fb64d049a77b46850e16446461ed0806d0d8962be54735535c9e39a5bd5f8836cfcda1c240c9936d73cd5d0a91c8efd6bf05ffd7cf056ebd2d71b396f7dd2c4269c7f2740c150811939d4fae60a1c2b434dcc5b8255ede44a64feafd799b66a18f1675ea40f08d9f8f0cd623a872df34dee3f9745da1d38272d87cbccf8657a50b0d5a2e397f09ffc308c63c29a26028a0acca21f125bd153edd25006180cf3201feecad276439cd0c50d08e4aa9afabeed4329b2dc729e2ce52dd568ee63b21904a2d1c2fd6b5dd0d7498844011b0eb189008fceacfdb48f00f30435fd0c2c8a2f3c3a61bd2106afb10ae2171acf4fecca7f40c0c8d6d9ff3fe62e5c5de25287c2281bd9bd6c0f95eff0f86e682d1fa566b6bac33bd7d0852ac3ac52d6264596bd5122edb30fd6bf0eddf4d51b10a536df3ea5a86265f3a3ca0529420aa12f77d9f7436b189f511e4eac87c9f7125b3475c39808f7cfd17b28f7039d9d78a46fee0e5b15ad98a303217eb153917b8324a0cb459de09b3c006801519270346b641d0b6bb82413eb9869b90d1de37656ec821b2b0af9df837fb78853fd3f6ce2db3ab786debbcbff58921079c26c2161c7dd68a6b4488be199e7b33130ca7c14f5e8226b6518f6fee299231dd5fb622ee4638e1931f6be352c7f6616724de90d2eec6a6072782b672f55442bce919c46059dd70167a290bd763b004473416157c3181a79050984962d3b5a489c19a983bab3e51cfdc18af37d9dccf2dea7f5b2aced4da18fb826e9ed21b61af12d9d556f2c3ff782e13e88e9134ced9dfd4aa5295b64f42f155f79287a7497952274dadcdf91801313825692fa07a46e5c3eb2b176b018d301a20dd82405671690531a6c7d1da1253619aaed857480a9b152bc9e0706c07b300ae8197806d188c0c35fddfbb45163b6cb105dda662701d9c1ecd96118dda3dd61fd93025ebf42657344f3c992db1cd94a0c5fa5e26a3b5bfa75bb601bdd23e2b3ea38a6424fe2a1370ba3eddde1536c39e4a12921202a652ed801af15a7d538d2d2381e8f7348b6c336b3c0f2ea947bb6f40a4c2d9571787085a2df68f3e7842aeba496c5283c1c84610cae88b2c6a2e732d486f5e0794c5dcc1f24918774c30bb33612f9274c76ff832204e021746167ca681a64969a523d8e7a61657d9873bbb5d41ffe979f93f776961f159f93c225e3172e649231dfddb5b248cc438109104aa5815e6aacd70a1ddf8d4772b5d3838b0cde255602bd4b90698eb807814644b5340b4b52f772831bcb157d35019d00e0948c986aac84fa048bccce07a58de32637d12bef355319ba00245bda926e50a75833b33d9646d119a6911432188ff2dc5fa445799e9c5aadd204db3156703cec98b8955d82052da241a92b020da66dceb6340cb909740f9ee34772456fd7e13ef8f0a2b7b53a6ce00cb7e56dd3d40a35488d75f2137d1f92d9d5b2e1b51b228486e6ebda2a344983d3c6ab49db1a202b38d2bad84ca4dfa60928bd423400117de83f763333337b866ccac65fa367c3d6ab9ff9f0fa363624138fe467b280237f458c8285d6bf103b84b5c568cb7efc6d0f2f5a941dba9a92665d656d755ed649405376310a60a05fc797546edf2cbac483014edc960388bbb8f52dfacf3ad07d21902204b7bae3e169495181e3e4ba5fdcd82335ecfcd6c11fb8a8dd96216dfef78d22a69d01a2bc733325be7f32dc71a27890ed79a06d319abe82f6ead633b54175e74a77165cc3901a7c0af5ef79769b5394431748ab1eddee0f1a624c5d3da0f13a48700b272c8277db09c3b58473cda1c58d9bb7faa0c35042c22204eb7c113a27f7fc55b8c17198e243c7453583fbdb2991492381c7c885a2028fb15023fe02b2c37313cc82d819e00fc04816ab3ea585007c01794f8d3db7c5ae4321a1d7581d75efa101d2ecb8538adf4c786033423d9339ee386da9c2f6817366d12101e2e5ea4ff3020ea04499e94a606520923c2bc734d525d42b916c9f34c02c689ad41f72d4df482bd026bd474c2a900c2634d6010aa79cf342de4a96304c11d548f9abc8c4adddce316bca346d1a1b1a30947138b966c6ffd63aef87075c99174024778dc46eb59c266800eff89fa1bada56f7a2a71420e72336be6dc8f7f6dfe50365a5119d8ea11029d97e309ea6f446988cbe5fcb640255e536eb1b920249b1c2df64abd12e15f085286a4c5ae10c45682d585f17bda92bff8fd5d90b38c29bb3c5170fd51b6c03be174f01bf118ba4399ca2874ae61b33b10dfa2eb15a2779b2337e90cd6d3f920be7562bcdea4de844f941fc530378398be7ee4242ee48f6b1e7de7cc7fe182e9e8c3ff28e85f52b0173c618a788d678a27ca41ce08109f34734e368d8055204b9e49f72926cfc522f6ab87b3a3c690d1a285c20bdeead9eed984be40a06524495799b0b139ffe93a9cfd7bb4e5a63a30bb0a8831a6fd34d56bb3fd5afeb192f2faea79f885910ad3d077d112e6394ebefac222ce46818cb699ac0a780d5da55fb0aa26b6491ba7d8dfcff7e5e2d6245fa5d31edc02d0c91bfa83089cc4f8ab11d1d2bdfde5c0b5adba7e5eaa45d1cb02ccf3893a7e72b74390058f1bcf01bfd010813b4737e05cc6cfc86a2f12123f9a9faf9673dccbd13c654da67e783a26b9501a8458a8637b5694252e54550f605ca8edffa69e527894f55517188fa1e7b50a6ac887b2b11779c01d86dfd6f2e010c1f4369e02f170661eeece35eafdff9ab72199d3d70ab89fc40149a96d7ecd7c020b5f8aeb863fa9504a79cc21a0e49ca99784282d4046f38ac0f929cd319e77bdd9694d94528026183c08b1effda18371b8c1f3038942269acd0f5bb3969fedbac095b0a324be177b3b5968d94b4c72fec8e49373eca33d38cf476701ed9a8adc8e0365a3b424427acc1422a4ad6ccb38f83e2ec57364a5dbe6b58ecc561af4a6a12f93f5227683cf5b8dc3bf81a47ac9d855f3f9ecb5890ca543db48ceeda39a582a0acea21a0aa6696ed530d1c93150def08360d17ae861aa3b205670ac116d2040e3e1b88a5a7027d4d4975605d8d699c1a1236955fc7f69a44e073cd3b9f004ce4c14d13c0a37df3238bdf99ebcf31c26ccae371672734ced3d47949bea914fa65b68df1775a1ceee06dc5f2f10c661fabcafe575c38a5f94e074bd4e203738506f4551ed232fe71c0c35b1f1d51c868dcc31f172da6692795b98383f02e64fccb999a1704f664d3fda464f0f76d0f49b8cb806c58fb90d2a2afdc75d9fa2883aad5ab222b1f6e8401389e2abead834b9607ff1010c1d851dce184961b72d1f36a00615466fc6ee09ab3a6415047d6e01e21e5a63cf6fc8895b18d9871ea6b91f14af03dd162fddf98e85e745d2f8701d65919a27bce5c5c4f6212e663e29ee8b5524b9a804765eac420894e5a348a3a6a77534f44f96ef6d467ec23fae9db2c48368ad7b0396cda3d9acfe7338d031dd9d6d930afb49dab59ad6bbd48e0323598ec1a8b34d97a01ef535048c6c607df9141da079a6f87c3e83743948c8c8ab93654119e9f8a3c2f324db178567bb11ad31ea95961d7aff2b096d40812bfc257c40705d14a032d15a25cde77480a027dcf8fcdfc5a08257764275090594b6b2cc31de4f3f5271b49d13923028fee28a8c8db8d2d39db8500c8aa02cd37624e583adb323ba33525c78d1e4fa1de7dda3719ba41a6c309b5228d6841edd267ee4ed63c6d483d1aed63a80c3612b84269326d8eb78597bc0d3faad9abdd58183dc14aa2e3b5f3e58b4bb683b76c10b4d129b403e252100dd4795524c83252a198d6e48db129769cad1200f1c5393c3ad50a765c0b2ad08e116cc7704e1d7254599a2205a60de195183a4c6c94133183a469439e0303b8d09d7b86f31de4f97c389a9f4ef712c91aed3d0f6784e0cdc1ca71b1f470e43ec24f2ee2fa6dc41fe56a7193d0cacc2f71e876bfe3d255bb537b0e6dd85fa1c5d2f450c3052f3a72e827e9f185f8cb2b0e7f137a3118037952a5b4ae0147122ecb8d3666a5df1ca66de778cbdf53598fbd5c8bf90ef0cc580dbac1541fdf7b4eedf6182c360943847866d5ceedc62021f2970d4e5217dda067dd9c8c9d603b8b630262f0f5d498d0facf299080063ac1c7c3a6daf604e28a32fb0d20ad0166624b276c82f145e2516ab34c6d61146c481e5cd5adba658d30541d81035438e547d65d097aaaa841b152363373d80fa459bde18a207109ae3ca6c77d6e93dfec4e0ce69fc0e8e4315260938a73a49c6708ed902cacf2d3868f08c075986af1d017e0749c52fee875a1bb7c2eaed914cc663b99063cee1bf8aba220085679ff52b70355be880694605a316cc31c3ebcfd4a4d1674cdaed33be2e63f32ab69fbb8db8bf8a6e140c14a6b85508186819707fbb0a9a6d039ac6edee24161f8b341e2311f3f5a75a54fdbb16aebd0facc8a400c73e8381eace65887fe65f3b1da230ec9f9fb17f1139b0f72131f134d7185399eb5bad7bbaaf35731716c4ad53662bd51c74c717bbf1c4802fb9dbf75625e925e815d868d201e4f10970fcb14fe0982cbb8e8ccce2f79e9872632db19c0f83b01d2b11076ffb75626b23ab2bfeccb4d9408594276974cb4347d291cf103cd8c72a814367edb14e0239b93116f957af9be120df73127736fb7eb243079695c10d2a2f0899bac8ee0f1a2496525349e0007211d2550328d95105a35ba798aeb1fecd3b6b6a10c6b2792c268056eb25b4fc41a481869b87cffce8dab1894216c5dc0d4a69759d116a0331a9a4263e34b70021f52891b8e7328d758925cee67025ada25f3a1049b6353cbf6a45770f34aaf293cc1ed3c655331fa59f5f003175c4bc03227b277f1031ddb901ff7bcefca159ae5b285f8aac977cf78f333b04a07433fa52c40a530bb9490aca38600278529108c4758f41a711bd2852f4ac9ae4b3303bf3bbb19b54d133a9d91565a4bbcab7b44df7fdeef96dbbbe04c009161dcd7b9848b74e03b603010fbd33a482169805d7648e6b8c1d53372edac382add56954586c32b9c62ec0c8098ad957232c112ba69d6006b51f60fa118e587bcbbb9af996eaadf3abe1846e02c0dbeda1dc4c943c321ce59ff75846abe3279d6d311b346295378bf73f4eb3a83bc12cccad1f24503140fa4a9643459e2c56b62f3df8bd4452582581467bb7cdeee2b245909d6514ead0e6ab458955d10d07bcde08441e7e5778dfa02a6f9f4ed1f54860fabb3c3514362fc038638421100d7e7a4e9239f9332edd8f62a174855e194a2aa2bc54942bfa89eaeb1caa7691a23f0c7bab1830b05b39117aafbc201f06b9ce5b27c9c5ff4e6adae80015eeb51fa3271fe88210b20c61935144946a27611d2469a90e4aa48efb1d959b3c939a9703eec766ae8d4aaf2c525e583aa8d6debebe02452592b8002aab44a9742e9601b1d520d945663e7d750bd4c5b71bcea13bafa572f50569c567bd261dda2589db13c5b2cdf8acd049f5517f600a1da824c86e5e75911385edbf6130b36af3063ff6c956b23e8] */