/**
 * @author Merrick
 * @name chatgpt
 * @origin xmo
 * @version 1.2.4
 * @description ChatGpt聊天，适配无界3.0
 * @team xmo
 * @rule ^(aichatgpt|aichatgptc|aidraw) ([\s\S]+)$
 * @rule ^(aichatgpt|aichatgptc)$
 * @admin false
 * @public true
 * @priority 99999
 * @classification ["插件"]
 * @disable false
 * @systemVersion >=:3.0.0
 * @authentication true
 */

/* 
基于sumuen大佬的插件修改，主要是适配了2.0界面，按自己的使用习惯进行了一些调整，原插件在这里https://github.com/sumuen/Bncr_plugin/blob/main/Bncr_ChatGPT.js
需要ApiKey，没有的可以看看这个项目https://github.com/aurora-develop/aurora

v1.0.1 修复了QQ和微信平台在编辑模式下不能正常回复的bug
v1.0.2 跟进大佬修改了调用chatgpt模块，用got发送请求（虽然我不懂但是我会复制粘贴）
v1.0.3 因为前期搭建的项目有问题，调试的时候找不到原因，干脆把代码重新梳理了一遍，具体改动如下：
       1. 修改api的调用方式，采用ChatGPT API官方文档里的方式调用，去除了原作者大量的错误处理代码，大幅度精简了代码
       2. 添加画图功能，设定需要单独配置画图的各项参数，方便用户的不同需求
       3. 修改HumanTG的编辑回复功能，可以支持各种回复类型（前提是适配器支持）
       注意：这个版本最主要是加入了画图功能，如果不需要画图也可以不更新，因为新的调用方式我没有深入测试，不确定比原作者的got方式更好，更新的话需要同步更新prompts.json文件
v1.0.4 适配无界3.0      

todo（其实是我想做不会做，大佬带我~~~~~）
1.用更优雅的方式实现HumanTG的编辑回复和直接回复的切换
2.选择预设角色的时候可以把Prompt直接显示出来，方便调整（下拉列表框和文本框联动）
3.添加画图功能（大佬的代码已经实现了，我没有4.0的ApiKey，无法测试）✔
*/

/** Code Encryption Block[be188605b2af9d5e9f0e7db22a9634fc212a7ad0a1e72494f09b567ed405599e3a6969c7bfc1217e57a59f2120e0f9542850a3d41954a72effbd7a1d5c4eab4bf188beb4f3e3dbec38f4ae588c4f37080b06085c349e7e725519765f0d138b461a28ed42fe7e883b0eb70234cde01738624108424084077d17630ced0cb199a8171e6aaf17cf64933c3ef4c8b1e11daadde35f592c013bf37ee4537a95dd3a7c2b22416cf55052d6073c6cc14edab7803855466110136d0495d39168ff17210f637eea151d25d0dc50597a454de27e64dbb41f3ae145683b8c893dddac0babc5966dc4a16f79f8d2cb6c07be10abbc1e262bd4c1affa55a88a20c0aa53227762e32d45b69ad6ba4477780083e279682a97eee88f9741a4d4408a13b6e9cd42163c1e319e39030966deabc631d62f3c17ae03fbf049d5c41f18b395f4eef9a31b49983b1ba1c53cd099f431b57350ca97a3d2fe2688e26fdcbdedc1b26db5b3c4facd6dc96d6f5c5919830cc03eaafd4ffdcd1b9570e9ac39cda4514b7d95f4aa412e9f2738b57d5eda87a13231bb499b54df377e6030ffd6e213619abbd69bdac7f4ff2161ac82ea402b73cf47fb75dbe850d2e6ffcbc0c75af533920c9ee6859a2ec05bb5f7f63f8338fcf632888f8e48aa120efac0e3072bba6555ebec3b34269a481e5fb16b6abffea1a76e28330ec9dbf8a17b5069b63218a4eb674d9bcac53f4063345ed5cf1179c47bda1c67c3757fa8080fdc2e95012c212df07bac8b8178e4551449231f242b95e5d60bef7c6e4a5c1965eed5cb51b0843b04ecff5a199c1b4bb1d20833640b820fdf8e04dce7775788a10ad0019750fb65093b112d026a3afd43f944ae7d53f238e12f734ce843f94282ef51361803aa256fd301536a2b89978da0c47bc518fcd9e8536978f9218ae2e15d0b762bf3b960047eebb4a224bfd80cedc830b92185302f0153b596255072cce8ed115304e71e699a41ec5c16090e5afaa4ad51ecd8a2d8589810bd770a12c9b27c5f9926f78c121d55d5b28554cb11e0a5b27d69ad7b8bb260d6c0c2035e5de7945a319000b5822652ab3b29c0ec4c42dda9957bf6fb6d4ef8756121e3db9386801dc536db924e7e35e35d898fa679f570be13dc714a6fdaa24bffb632eb989cc3730161e8dda6ab598a30dee7e52c512286e73cd6e8c9596f3774a676f4b90ac032133b048d673002c96e2861ffa6e2a08b6df07364586e31119eb0c484ebe396fc93851b3012e67b409475b7831d4770761e1ec0738b87943e6a61218bfed5a8021316de10ba0c7b8b82245af8fb72ff0fb664de36bbd37bc5d64c39ce2dd1a98291aa341664bcf073a0bf383c42f046223a6c199165ce928ac8aa8d5fbf1f6f1ddb14df798c4388d2061bd73ac3d7dcbb0e451ef0c4e27e5256abf16f11ac89d335312dae7d09a52af25c6ff1c581d8c3acbb68a322816c0d7f3155d76fe0daa127fa2a871cd0c57c10b741ba6eed80f3768d1af6f83b340a674658ab4032f490e16d8d3e39f0944aecd4c311c4c2bf717c2c895e469f669ee3663a0fb5df308098effc5d7c1f194b215df0bcef69fa4d6b98b410c82ede8c1ed5403bb844ffae4d50afb6dd8d9af29a8a6a5773119dceadf2864d0f1f5fa5c09223cf02536e0f408106b1fa322a103401b35e494140393dddd915d6c4a79b747546621a417fd7ef316e0afca44639693fb0e9c825c83b1d98be2c52dd50f10a2043993a4d961f0e8a63b2bbe0c89e995c07bc62cf7aa7cde7682f788868e9c56a48c82f9a7f114edc72ace9e2d21aa59b810d832c534032b1d4332ed2875de60df62a0040634642a094bec9ff7c756067867c75f090740fa6d7538e3eaaf6f1f51926ad18c64ff5c59fc7ad13faa04a5a672d1711403e115af942b93b0ae943a161772a413d02a8969057eece874ce9eb7a67fc1c8a288388f2fc391d4b894b42ffea1656376863d903d2a18be481b6e72d91bee6d0154ea71b9c5d2777645ce3e409046eae68948e6f6cae9f43df22cb5fe0580b73634aa192b8000486e7af3931fcfc667446f53b20b9959fb7f2214415968d1710b322ed4d2a7d5dc9c7b59f06119ef44040808d1671a9a4223d1e43f04ba1e58a20f47930d05d31def8dd5bb68c852c5533ed3203fabc11613442310865392c7e4309c45cbf159fd9d9d96ec62f579571502dd4b4e60b3bc825ad8c31b8f91f277926397e407d1f7387a21f0b64673523e92c6eba07576096a208f19a0069914a47dbab83caf265d869d87f2e83ec616bb722b37011400c972ba79f2215244ec32e6dcb5a3b47c9f9336425bbd48abf7be2a5581101c7cf73f9e7393693bc14048a9192f18e205524edff6c4eb268abb6f8a3f5dad87bac045a5f9bda4fdbef8c9773f543d33c7ad9a0ed0ad485cefb8a892f817385221cf22c3e4ab2cbf99237f4c51abce21a5e8665af804146f325edd0c86da4a86c880a7fc120630c61e1163ac7e1683df0d2b37a48d755299429a2eb1469dbd8558c11af5a3ef4b3359e6dac2b0061e7ba77b99fe97171a19bf6912a88bd02f9cf28feabe417802b87eeede5e6f168fa6db253fbe93d60c11149c373d5964e05a923f12f81b32defa1dea5f1cec629b86a1abe6a81b146bf09133b01c452f0afb209049f6619e0b16f98598d3043062c5e6dd7ee8fae0bd194ebdec1616349e6e4ff44fac539c224d99299d25950b884c0100164519c38fb86b8452c6f2fdf9218ec99c8e0ada2814cb195edd5082092fe1a34d4b44db6f57922fe4084a5480c57d177f21700f9357b4f0af9c194733ab0f022fe6a1fa663782bf28e0138ec1227e5fb5e592b18ead0447e1bf37b8eda1c7a02ad8c7a427bd854b3228333d9b0e2dbcdf146d327c26dad6bafb072cb8411d05eadc3e66222794863d92f6bf300898611f284e9f38163a4b6a8acc0ecf47f2c78f90e7795356a2ca44b0e12e2e6211249e0fed761019f55c947908eaf0256e1464e37c621b1aa121fcee0528d1e1be668574e2e9ad9a174f8162d670c755d72530101dcb152882840d762c8fde72fce3751af117f4884987f3ee8820c179d481437d6f8276124e37651c58f30da66cba21069071e45ee35b0af68e58a45aad55f824e74eddfca41f8efb29330db6dc07467e82e686f6b444be065c9e219092b62d5fca2f175e5133c7987330e4585e4d8598e392b547f531931cb2f73db7b3f918ccf501123245745c655d880910afb791195efe6deb906f12caae65bf6360a90bef7e33665ec7fe1b99e8f44985c622d3207f52dc0bfe2e7e2a7f06a8205f16745303f5670bdb471c92904808acfe34bf4f0f059d861fab22f0533ec5cd557ec362fc014c8f6a2fa44c6728aa1dd777ae010309f75375b6cf83c6e048fd7539505757ac84a0d133c847aa0f51801ca99d996e63ca9b98186a4d0e19b3d9411ef61def7aefbc9128a9aa624211ed6d3aba2de84cc8576d69d2f8496dda2b7ac913456a25a9c63b608aa65f34b26837204fa5d4d8c44eab93379d44c2ef27814d1d11c569609e5de97a899199652935271630c9c29bcc2af144367d35ee6fbb56d146fb53026b3a1416024a1696daab6d463b1936456c45f63c3cbec42637b2061f47fcb68e8b3955ec09849dcec8c9e82704c5b2bbe39f6e7596b47fb97383f999b3d59021e84657c026ad1fbafb8c74ed67779edb79b979d7f76a624eea73202b8ea40bec0165c2a780cbd1a75d8aac7253bd053b0e5c7962c0990d30cb874d94dd7b5c7f4504af1a9a75b4e3edb1ea7a3de4c967bac0aba057c4d566a9b7fd9aeb92075de4c56a19e9ea08348141bc5018e836862729bff87fa41f6ce26da3439ea69953488b0bb48a708745ab324a5d7ad7af959172c286974bda138faba1117c894cbed75456ab93b44ddcc368a62412a2017a5b1e68aa0c7c8510207018384a1252e4bbc5da33be6a674204b8c592edfdf69c92ae96f47b3533ec8e0b857f4f48c13ec8a99cfe9fa0d516719839bdedd5fcc1bfc292dbf5252d7042fff2d3a0176f06ca4ee18debc24b9a79565f1decd73b933f029ec5a78fe6ea6dbd3ce52b56ed0998e4b87f9067a960a5224ad26fc375091cc9f31a81bd5b5735bfc3e9cbd12012d4f2c5d23322ceffd2e26f59be2857dc15f464469f9a3a9aea4eccd49a5cd051c0f8363643dc77cfe1f7ad1e982768aa68ed95a5829ea0bf8e1d2249f05f809e88905b27e55864426e458afc9e1db340bfb1c7501ae639ae7a35bee3b9b31cc1ea1616942ab792dc1c42341afb42dd83fadcec5394a52a8d976ea12a72cceb7de148ed40c12b99db7c512c5f585d13ad49cc0b0ebc59bc47c11aea757875664ac129e64728b09458db33eecf5a5c1f36a649368a612922b3ee217c11d41a2c00d3d44164cba6af8fac93af8767b836de41b31f1876073f85677f3c810e3227dbaa803422642a720dfc9ba963265e9337610413fa33c0f4f3090557fe27e8fc44c0340e8393d1f9e8f17fdbf66f4a2ee46181888d3d5ac130c103a0986dffeadb18eb992c8f819dd36c7b0ad9e8b470df3c56085396a02151212a596d888266419b1fe9f14ace247a34590a010094b10ea5673003a0ea5cd2492d2871da100f0b9aa89d1b6c8c6b97d8b2256f21f180d537d7ddbd6c7baacb604ede64d77cde4f1251cea7ef3b83fd1542a7e77738b044138a3c736525d115b8dde7fdafa56343b08a71074f2a67b82f462c4a05712b4d458ca17104658b3e6cbc406f9e1f5c780deda303dc29071d2ebf4326de55a3b3120067e4aab3143fce9b3cf14fdcf1444d2b3baa5deb71b1ff723b0b38ad9ea01db0a053a9ef48086a2eaed9361246ae4beaafd1e940a18dc8eaa4477c46e97c66015ec06a56f5495cb512b8ed4fa74ad0997f5be4ca7039b5022badcdf200ef976f750b96823b5a6a885ff39578d75beac8af3590dd716429bd64dd7251c88c61acb0cca6f418995c201a319c0914c9f8510af0368c74b671881aa1f386356fc88715ebd25739bea236dcd3099b404fe93d6178228f96cd6d8dc5d348ba158fe344595cbb1bba1b32eced189a64ce74ef1887dd7e2f90983b3538bbdef30dcb3f588144a9d3db556c60ccfe0f057707d83d8338c0bd6b6ac2b3de4e3a2c17f63bc9c4652aabdd1e6e3086173550339f2507c29c5f7103fdba3f3b9e1085172a4fb532d5252d432410c2c5c202dcad1b34b7332b36773dd26ae3fca2381132eca3b685b5d8f2d1f6b08fffa9e66c0004c220c831fa79729633b9bd10d57511b74ae375008443f9fc27b70a5e22b7fa6eb8ce718583f7824fb34e62b058b8128652712beb3d7f7aaa68de7d32286545dff53cfe8c41dca9b6329959e3ba884345fd7214d355f4eee2da0634d20160b21160c5f99e468bd09138b1b71ee471a3a6d7c90107c324a600f658db3becf2f2bebd83e41c5e71286f91a5c39ebb3baf5f9a73ea5ea1ec84656817814fcf496a5816cd9b15a638a7c65b7255a8f2025f72264ab645ed3822926fe55a88858bee384e987f9fdd62f19eaf3361b189c5ecc85c914359d2f512bdacdf41ae147f0cc1a8fc555eb817d4bf69ca7c016dfe1ad91aa0591ba877955e29b7250d314358cc529a9eabae888f87c8013eb580fe91d8c4fae49f6afbf64586dde497ffec30ffc4956733dff76a314a43144c0e9138fa0d059c15846cdc43f892f17d2826f69d5fd94a3f8042128001423fc425039219b0ccf8029655578d6da9a4089511ed1ba79a9bf58ddf5b7c8b20b1127db8423b0edcf80697bc371101c2a20f913edee76303fa30767872007b988b073608c5582b6696ecb20f89820a407fb15af1769e9ae5287a4a58f977c8775bdd49a1e593626b9f3ed169c2c970ae46027a327d9b6404feb4309cd1c72be1b79ba3e78cb4b58699e4c36f8355b520052bbbb7eddfba704a1326adb85d8e6690627f6252a995052b93b52f4281d940eb69ea1ab13168bd0fef3484abf302bd588024a385b7a7138c98e4e054cfe422ac825ee086225b43781989c4e7f541be868298486d006aba1fb745f5f34bba43bab0f4a95a558f271ad7d83cca5ac84bd24898d06fbdca48709058f7fcaa712fdd62703c1a5c292c24117fe674b0ebe19c537da294333ca13a5a8d757cd9b848e75fb6fe89eaaa97f486cd83b120dc494e2d079181243912a49951ac68efc07e5398ce3aa2ef22dc363fc9fdec64b1610e44933445b766a6543bdca1ff70b8680f566a73d844bf99bcbab1f5576a7a10c50f88f7bbf092794ff102f8ae0b2184a9168abaf53e9474002a769ff6d4d157dc1d08916e307b4d7bdab2ebb67de292f50679314eed30e8be104c33944b7d907ba3e2f4619d4a207d3697ac597daaf48c7e5f3aa4ef8beae40f8474434e9c28d3307e9b689b7e232dedf18bd599b5179a01df2455e3a5a08439b83bd77996af1d49b164ee904c3e55256ca772e8c85cdf6b283d9ccccd17fe40c335ad94dcbaccfa4270eb88910ed9df16909cff2b08979b0eb397d747b1785e2ef7bf7ae031f3d62bf6f26254543b02b64bae531890889c9c3bfa798e00af0b7c5f2cbbd080565244b0b2fe35e465cd252e6bbd2f392d08a48ca4f391c1cfb768f81b37c6b0a80a7dec61b8cc07d8e7394dfd11914c489fbea8ee5d7b89fd303265fc70c5faf8218fe25fe10aaf3f45c5f505ae729aec4c0ad86f98db0d15e3227e744c4195696d22cfb2e308bf617712cf1b2360a679c0199404801435cf9aa6d74c9667afff96031a55a17c37c7c6b6ee0f59063e44b545175707c4d341a523fc6fb5805326b4c56ad35682771d11fa57d3a35ed421b25e6f795fbb13119fed659bd4c9f7f83a99fc863d889457655325baddec8d2b71b30d8c5522fa6bd50ee15784c4948a850d6da17012cc554907136a793d6d6f3d442e3147bfd2f0f42ff67043f8d7a4a2111d8dc94eb180e3644346592f32f52b1957a253ae34146a616e9924c966e6a107d1ad4ae33259180fe82cafddc1cb502648e4193afad42ff177fba844b510f04e0f81b91925bf82418e5272b859f6da0854597a28bdf12cc29beffe42d57b40a2c17e2a053acdd94a9b146740e0e45810b9235624b0ff7a878d2ac4b4fef5b0751f6dc4a16e7011f597083b751774620cd677cd3841a55da8b76e3d40f9ade30294f8c637422171174208b64b7a241fa3d9b132b035d77fd701a829a80c89c47b1e712e11c5efd7b60755dff179c9cc948c8b5e7ffe3a5229762ff356555b0f3bfd7f6a75ef591c47467075ebf519846d435245a248bcfb373282ce06ff20548cf2b0b65201e67f6b7574402f8da3c257c1c1aa516eb453837927db1e7c26189175adb59c2090b31d016e53566f37e4523396bdcfd1d2b51d5ccea6e26645b6d6c3ee51bc5158eff9c2743607c7de8aeb8eb51e8c554dfeb30fb80e5bd29f1270b845fdef2b9c2bea1d71e3b3ad6565ec207dcadb4c33800908ba7452dc3eea68848569733823d036a5fb0fa3b8498d67bafbf309aa35d1f738681b2fd5739fb9c993239a4cce844d5e7872ac0c958868d55408a142bc7a40c296340b005e2af61b08ccc4ecf5f69966a194c9d71fea5e738283f7f56f3937db9eac60c08bcaf344ad16773aafe2e9b39ee6f5db500568aacb2d39d76c38b44bc70bfd63b460bc9e603f71d2ef41c20254438821264760cb2bd6c6360e8bb350bc4d937bcb6f2cfc25bd9e54d993aa65b76f5e67d02076bedf1b6cd5330279f1a713f4a29c348a05d1ff246cf37d82dcec988e9b8fb512a2d91d778c9548b5febf0e2a5cef5ffe8b53e1c6fc4409a0725b0af82b9f8a443faca4dedc5ac674531f58d03e6cb0d953e9afc0e332ad576057efb9629526b89d9d49b490fe81a0d4dd588943aede348d6c76445437ed259427da19ae847e9de5ab7ead3f2bf764b6052d35c1e9e398b99096fbb3c9017e39319612b5b30293706d78eaac83ccb60bf361288a667308ad5c37b0cdd72008ee11a6d950e28bfae28749bb84fb58011b3c8d5956098f285e3fd0747b5ff3f4a5432b521df36ef14d3c1125311f9264ba9019ff612bb71e5c8e8339cadfa731e4b0211130a7d182e95aa58788d90866d13d0c022d494d12ec3c56d22555e1577398b7fbc6732cb99778cd2e42f8c24395a9648f01abf81e171b6f92a2b6f7e3754321776f8ce561d3bf5f325984f1e697a51c4bac3c69b9a0a1c00b62aea6389062c08392149b8e5c2e8954bc94e679ea05ca75a8327d0596a81e22a6871c6baf8304c10483cc45d930656299d8967ad73a2821c5e2829c40b178c955ad07faead95c87355aa9a8234f8fff97fd873202f91c8fdbda3e23a2802090f30b301a3b9b331e6f6ca2e45a4865428f78086b16c2a5686e730cdf0f8fe66544aeac18c9e90b59cf9e5589af42c65ee557727a74d7a279e9158dc228740425003e3ed04df022d31c43c82ac6607f5d7b58dbec99a99e60d28def93b8abb5099a63ccca2760e64cd05c667c7ae09eb6711b33b602ca13c069c7eee12598f1500290b653e73a4d9d07391f3ec8874b6197303bfe78edc17c51124cba1b70cd0195736995de4e53a0e2ae4e4e49bf0a0dea8d2aab0b46863e68b0b6aa41717959dae82e4a9cf75d15137e49f00734be47f24fbab07629e62c6108e8a58e050c7dcbd08dc4753607f1a94a02aa30e87d7f71bcb0d056af1c1a44616ddc69a346fd7b9b088e23d36c953ed3dae417dae6893e6edaeec13df34959fe1c86aac2dcb502d0df1399b43e1370b6155e0c169f9cb49eef7a71d5e0a1f9055af9c438a0402d2de74b3ca909cb53787b0d287e9a5992a8d739a11f5d09a79e0af90503a67301398ef6c658100924002ed111765b2c34dcedfd2bdeca1da86ab2bf4da7bd6fc1d84eb161c59e43d207652f4ebec09d87805b97ad4340a97914438135931ea90d58ec933186fa5c208304ac6bd0ef3c5da769b7618cfac0cce1987c35395e5d5f0e2b998757450c9b9c0824bab5185701e3b9b372f54f5d523e463aed2075a3824cf06b73b5b5fff8eb9fd] */