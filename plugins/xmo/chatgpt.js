/**
 * @author Merrick
 * @name chatgpt
 * @origin xmo
 * @version 1.2.8
 * @description ChatGpt聊天，适配无界3.0
 * @team xmo
 * @rule ^(aichatgpt|aichatgptc|aidraw) ([\s\S]+)$
 * @rule ^(aichatgpt|aichatgptc)$
 * @admin false
 * @public true
 * @priority 99999
 * @classification ["插件"]
 * @disable false
 * @systemVersion >=:3.0.0
 * @authentication true
 */

/* 
基于sumuen大佬的插件修改，主要是适配了2.0界面，按自己的使用习惯进行了一些调整，原插件在这里https://github.com/sumuen/Bncr_plugin/blob/main/Bncr_ChatGPT.js
需要ApiKey，没有的可以看看这个项目https://github.com/aurora-develop/aurora

v1.0.1 修复了QQ和微信平台在编辑模式下不能正常回复的bug
v1.0.2 跟进大佬修改了调用chatgpt模块，用got发送请求（虽然我不懂但是我会复制粘贴）
v1.0.3 因为前期搭建的项目有问题，调试的时候找不到原因，干脆把代码重新梳理了一遍，具体改动如下：
       1. 修改api的调用方式，采用ChatGPT API官方文档里的方式调用，去除了原作者大量的错误处理代码，大幅度精简了代码
       2. 添加画图功能，设定需要单独配置画图的各项参数，方便用户的不同需求
       3. 修改HumanTG的编辑回复功能，可以支持各种回复类型（前提是适配器支持）
       注意：这个版本最主要是加入了画图功能，如果不需要画图也可以不更新，因为新的调用方式我没有深入测试，不确定比原作者的got方式更好，更新的话需要同步更新prompts.json文件
v1.0.4 适配无界3.0      

todo（其实是我想做不会做，大佬带我~~~~~）
1.用更优雅的方式实现HumanTG的编辑回复和直接回复的切换
2.选择预设角色的时候可以把Prompt直接显示出来，方便调整（下拉列表框和文本框联动）
3.添加画图功能（大佬的代码已经实现了，我没有4.0的ApiKey，无法测试）✔
*/

/** Code Encryption Block[be188605b2af9d5e9f0e7db22a9634fc212a7ad0a1e72494f09b567ed405599e3a6969c7bfc1217e57a59f2120e0f9542850a3d41954a72effbd7a1d5c4eab4bf188beb4f3e3dbec38f4ae588c4f37080b06085c349e7e725519765f0d138b461a28ed42fe7e883b0eb70234cde01738624108424084077d17630ced0cb199a8171e6aaf17cf64933c3ef4c8b1e11daadde35f592c013bf37ee4537a95dd3a7c2b22416cf55052d6073c6cc14edab7803855466110136d0495d39168ff17210f637eea151d25d0dc50597a454de27e64dbb41f3ae145683b8c893dddac0babc5966dc4a16f79f8d2cb6c07be10abbc1e262bd4c1affa55a88a20c0aa53227762e32d45b69ad6ba4477780083e279682a97eee88f9741a4d4408a13b6e9cd421642f729d9693ea765e4255debd064c057e1ff0f2d115c12d91bcad0776c5e567494c050f0895aee03787b4bf6b532294334ff31f2537cd7fc0c558c5fbd894f434071f874325d0d639806a3df2449a2e745e4e8d4312e955d92acc7a832cee07c8d798782f51c5545b0e38244d875c7aff3c62a5231d6851fedfd51b2ad72c07bab4ed874bea62a3293ed19cf128c7492830713e7c1e14a6d56ed8682015ed796f3f32281db28fac4d756feefd80330d8d81535130a065583dcdbc0b85c59e5924e75634c3f734f78590f06b946899d115cc1218a5bc2f8e32b42e5f1c7a253f6f95a7434a61a9bcdf1b74f687d6e1ebffdf783c20e169967c86c483b536adfa519fb9df59cfd99335793dd6f45261455b6fd9acce8ec0168a33048da43956670c1e639ffcf015e1a970a10b49d8fd2b884f1227bc69a53f54a0a7a4d85d974cc6453c13db041a888b550e34f45a5afdc4e5cb224f0f71ca3b11d9860e9dfcc68aac8e4aa2db1ea63a847387c93972ef5f9d1719cd047f6ce6f70dce8844414629f76c97ef19e9b7d3ad28667cceb2361e50c797c0b8ec4148c45b1e99c05eda5f6142e4de33de4abb419501684974844fde2ad54db01bc01bcb4dfea066d6efe68b98cc1e6375a6904dbf8aaffd560092d60c9f1863c8ff947c0502aed46ba74e4bb01d8584309995cb685ec23e4c5ed281e708621a69f08349315037d35f09ccb5d9d04ebcd98f795ef00d7f51213a0454d4efe3b6297e7b5a9ed3dde480163d0660397a0f32bda7f158b01716b40c989e7fd9d893d4da91132b5f503f4239880b1ca9eee0da2e61480b6af5d2d30cb47c6134d14d817f2d138aa936af984bd2258c3d2959e4d0cc4123ad2d3d5be5ce2b5cc872f256ee855faf2e250af3af72ddcbfdaa08db85a6a639f89002efc5b454435f9057ae2db25695059f5d39de435cad2437e1a1cfc337d35aa881db12fb4ce550cd35f4bfd8a0187ade58ba5aebee0ac13985e903a2386620237f275ea1f6cbdf51a88dfc4ee265201beece159da2debd87e6f3fc5360ee25338b80a453999ffb87612c253c961e4854f439dcec79d1086a6a2e48df3ab804a4d14b710629769769ae08f51c9dd2b58e4f5962027225aafd3d59f944fce9fad2cc180c306f2e39b93eaffc29351f142d4f5296995d51d0216cedeafd52bea7d26b205f7fe816c0765cc0c63dd8810963775134512217d279c9b7cc6e109c54896361e1f76bff500dd169808ff85e8c5938fde39a027e96bfce0370e7cb4cb41d2aa6d0f5c853cffab9e5989993402af67b9ca78cb9170e648ad80e666472182fba64988ffce56bb9281fb49eb9deee50966a3afd7706517a61b17909f5dd74ea1bac343c1b6a7c48dff30d721cea66ea46342c109b1dcb5adbab7490a69718adfb1d9098ba3b07cb70a54fa22795b2f3a6f8f92edff428f3528e46471e8981d421c9dfd85998d7a4f20e9448fde6a2c2d1f27e98f7e16293db750a445ba41b1ae5a6d10e09dc80b76faebdd9b2fe55d962426e65bba111adc879b795bf88a6be2a4fa6f1fb6ce39476f5c2e7cf76dbaa6ae5c2b847b31bdbc356f825f1514e583af3d4495efe996f94f20b3d004b387c8557ba374a26b77ed277aa75e70d9adaa6605cf94a03ca89b5b3dfcc5d10fa8989e41b3ca4745f858e04c4788b430246630344d53c869d2371617918e057946b27cbe58b54cadaad8d1bd60b4a42dd466be3598a36aa218820f7d7683e316e9a1627596e3146190fa9ac21fc3ddf479c58b23cb36ae291e17986c57ce734f3812c61176a37434f6510204ca17eb15a253853b5ea81aa48e87e1b83a9e021a488e077175fc97e3f64b06df9781200521e06a273f1072310a1447ebad6cbed4940e764dcec9824c2a3f41a010308cbb43b83315d7921104d2679d7ad006805a9b8e2b6887f6dceddddc61fba29377e15deb2ed56636a5ee5b2842414e95e9d54046363587f6a78b1e673d84bb5052497db059e4c9355475c50139b466fdf0718e5205397e9ddaead7c242be067aeab34a70b51bf860628cb0a4aa38dc6a0e74f7cb96705a81e3deb915f48a34f7f95ad928fc9448f1b093334fbde760400c1529e2266052013a4d70c219ed44702118e3a7f44f94ec7f4d157fb71f772c2c249509df99b47bdc7acf0895a98d0904e5fb09622b043e005cfe89ee27dcd83c44193ece2315f7857477a563eb94fc49bbe0212511589d46f22823a4f6a316faa3e7c147082582d243ce8bbc161f7c2c32f08f8bce8f4c5d3ac5250f104d31794b287caa79477bc468149f1dc653c2122d961440446616f79facd8acf2bf4c0803db672d8b356a64ff2d14ba1873aa612694abddd11dfab28bc103555e644ef3bbc503336405d00e32d71538a7b8e096a3c2e74ab9636afc187957049f4db3ef8be526b3223e2e4868cb72e9691e1120366c4c4aa89434edc95b2b4b1705541731a0cd487815d67476a56c00ccd9659a689ff1deddeebc18669a1535bfcb5a48ed647a6215338d841ffff7d3d32b11f39b64f24175fdb358ff94271922e832ade0f00695eadd2cd95326e11b0054fbd1c20a9ad6cc0d02bde0e7fe7dc229260081478bb8696c0f3f4af0b18a1a8e707b60ca59d3251bcdfb1ab6c64b3bab714aba8408550de19ff1c1a1ecced544589db0fdc0133ca988fc136ff5ca92c213b43025d4231f5d355934c3bd0d9fccb8c48b2574dbc5116cbb252ed3f0a469d873c7823745914579ad1122110d00ef1301a4f421d4d76c3ce09f9a750d2bbc905096247a37e6709648860bfd06705657d431267f72ccd70ad1365faba3933758788f55c7c783b68db27be8a7c71aa1d178463608d1d2019caa053df3ef62194bc0bf9f0600d64512a40d021f0253ad5e7981631f2629a140a03921e4fce489fe465788936a4ca25048aef8e11a3da7348c7ad4310be148070443aec1dcacb41a814f3642053ea6497e30cfa13266432c298367b0fed008ccba6f9871f3ee90cc716639c568c0393157170ffaf12ad8287a518d9172e383b05c2130ed068278e1eda431c5e21cac7ccbc3834703bea9bc5abe0572b9e2a5ddd9ed4cb67d536158cdf9216d194a1606aae6f8e5eae3f344d8e0919d736adcdfe0f7a1adb5533405019fb7a74a7382a91629f8104f2bcb2bab242375d0c2fd9974f7e8b9a6564bd5196afa04d25a564ddccab23a11cb2592d04924814f9eda2f8fcb68c1facc81ac0263ae108c6fc6e37d6fc1d11d5cad4cfc3ca4bbbb4f452f7332f30014c6114ab7d9ee612e6e59a38f682c1895ed3972bcc94601a8db9177c15e37cce465e181c1485c0b54a17b270890f894b40fa53360243f51664e56fdb6614a88552c4b9423783c00684205c503dafdaf3d7af6ced70378c9376b01bea603b3384180774562ad64c9a11c84314cbb9e97de6d53fcc6a4cf311ed07d15c311375cc8dd742991a2964eb43f5f6cce475ae4b0335f11945c752453717231b4c392944b68c526a8afdfcbe6636454289de211c7f1c0092b82fc5fb15cf976fa4fef5f3f22d79572d7b8aeee28a7626b8994e4d2a330108f172ef8bd131447d01226036408f218bf9733df3b9e4ee007c096b2937785a4f9f3a427b5a11883656be4392c1eadc4557039cc2b403d7efc243f9a15407ca42a2551190d9be47dda461cd95a095a87398ee48920e249af7a2ac78192baf76dc56355f8129b1899a4970f3489b9629c02b6ffdb13c56230e8312ce4a2725cddedb4dd5714644d0c9eb1ef078f664ef4c0cdb08431eab86b96a1e93835b540ed9b1a231defae1e7052536b901199e857962ea9fb11d0a2cb3ee19f324d720530d546afa962fa028b7f3c1fd91023e4e5f7185944cb19d5037e885fb3ab6897ee1fe6fd9c5db7a534921da6b9fd12b8631358fefcc0dbadcd7a16bd2c930bf067fb427d18c72dff9e57bdcb6ae86cd2958772ac81f030e65a8137d73e1def2e1d1c7501efdf67763dd66769ee8fd19ce95bde2e22bf50700a0b782db866d2bb48952ce66d55882a9f9c229e51cbec52429eed8a4a4c06be35ef5fd8e4a2b3548a7763c024f0255f834ed0c6cc27722e63741ffefd7fa7c85b41d3a838e25d4097da976955ba48d3456b2ac06a7cced991a1c7ccb8fb7942810bb0c3f82db74a86c9024c1360d6a8936ab4e2f56e3f41d1e3ced95e9ac014e143991a82f14ec62e1172c3ebb3909a8022ddb069e038a033c362c574be438c1e5d3236b3a62ea7dcdd53d9cc3510413806dce5e3af3abcc018efdb1e700ed005be1c0cccb2c58dbf918267a4eecb209523d18641495fcba7b9ea659b87b318aa8a93c30b972fb6567425a7b595248befcf511f1934700a38da2009698b964f24313065ba6c8aeb04a96396c1ea68aacf808a47c89ad1ef3f7f33bd1f43a537d162242c74f93d650cf7aac8cf1b5b2760337f5dc753f4a5267e67c6b16662490a56801ae30cbb6ddf586c303777e5dac69c4f5041a13a1727e6d2584d2b94dd1ac30ad5b0f458db416a634bdf2e594b00479f758b6bc4be0bcb0d68f62885f6379123b76d5fd55d64d94b08464850186326baaf43042cfc702db4739c73cabe9af11e571c891a8626fe7ff198fc31a39b66636b1a3d3327a267573674bbee100cf4c297c59bfa76d16146001b14752b8daf9db377f0d7c601d025017415213b1cf680946b1f3d3ca19b6530bfe78161c34271917c1e0892ac5ce6a5f0053e7374a662e30eff40928519fb53de987448488062c6822778c01657edeacfe44dea5bbb711e2df6b8229438fba966a2ddcd9015bda6ee4f15e9cf7cf6e3dfc1b50d425b2a8f89a883d2aea64f05ef0e7c7eb42ffeb170eb8ac2f724ef7f2b76d4dd6b0a6875e7bc118742561ac73516309a1e807a9776570031d310cb55901b5bf89da52a3e627d824bcbb31bff823e4d36b231ab4dd7f8733a7bf7b2e5a07da8582d11a0a2d30c372d6cd6ec3ad99edc1492ac7a14a1bfd04c5a7af90766ac5e9755cf7068681744a0c9b51bb4be4c777bb30f6c225cd389d81901b591aa333305d22f8be0d4eb56de754c89d4a9bc1a14f6b6407fea9ef6e228a6edec5e8f8721851c84bcc3003d595d901ba1117db2bda2e93dd8f4b7977a5c3db5402f1da85e6761bdba228973fdc0f1521384fc0fe1633f8741b9258531b0ac62ba286b4ca058d35a7af577538b8cb6d167310cc24acb849810699212c4e7e5c988e563af118e16bf770e7c6f77a05b3528bce5666fb6447d7874199797894dec700b885ebbc6451ede2c628ed4364c7c16b66b827b71787235d548700a452e701a5715b7d5e9bd312d9cb6d616c0f0a85ccab1e70cb39fc78b274a39d1c41f4af194cba503a675b5cc80dfbfa39ceb544ad6ce6819c61a39e3abca0d3bca595ed287f66542e603a5ca3ca4b823f2aa59fc536fb17a1313eb271a69ff1b747ca0f3f61cd0b1db2cd6b6f04b5ac19faa65edf97dae87c6e6b88995918d20cfc23888254fe0b368c55a539b6e4fbedf65cca9b0f9e4b6461e87459b2ebcbed6610d0edefcb95d47a5a08ed5a34ad890cf9fc509bbe3dcad2a91f7aa42f2a6b9b4990ea6858eb0b49626ee55a6f90b3f7a8910c37471657a80725e04630da891b845560d77d406bc2a7a12421546ff4cbcf355c2628119961d494ec609f231118f0ee520d67be4e6b900ad973fbf648a3569fb5ed6d17ebd3cfc87f38960dddfc21d8858e042406529e662251c42368919cdf9df599f8fb0d71653736b4c5eb63ad7a0e78d23406b623d6915199a2603e7c889685cbf45cd4907c55da8c7f99592a9c267a40231e716c3dffe5d49f4c1ba6b495e0bac62bfc419f3be59d4f806e43336346a91b0c28dd08c9bb0eeeb05d217e2978ac1caf28d7caeb37c4acc27da004e0081951c6bad11cf4b6c898a42a68483f8796546ab3b9d38659eb9c840fd1e74f0324f636a4f87a5885daff910a41dcd4a9e9957d43ba86af3983c28900242eeeec2aeea7c0270cc0b21ece6f8f5f99355ea320015bce6314b0f88a8f2d2d355cbd87e3bcbd675d8f46a536286a63a53e7c4eafbf53a93ddd8b1286933e02d157a058506e295490c35288a923c39725633793d9b344d990d09cb9bcb5479bc2d4a7256c3d806fbd955556eeb940767128b3510d9bfebc41889d5a7aecc3ff97f20426521b5bd070f03c29ae2664646eb82706db31cbe3aa4ff63cce7d25d81f45afeaac8fdd27883d62257182873485b6ce2910739d0268bbac26187aef7fc00e6bbad51afd79c660b81d3396891ecdc0a25f7ea749bdb158f73dedf645061f3ec2226d4afc8c0dbbf99fe7809a85ab1d7971d6db655b3f5a4f5dfeab319acc0178c79f1a95a9069b6692b86cea0075c1e5955851f45d665fea5bef139c182ee1631abbbd41e021194b899ce049299940e0c906382a668f1188dfe56dffa935057af8217a149d1e978c59c91a440506cd0694af2c1df0bec60fa5c01b25fa2788b961de9014874c3f982b39c75f90b7fae752f4a140ab52ed1a3e77f90c7adc5baecb7a3fc7e304fe9a55e421e858f19fccc555b8836881053d4d29f3a199edacb0a505f9ceb98a5072fe2f625f06a35814911a58b28ae899e613af845a1bbe41f56bcc92bde6a27c43b7ef0716befca1d406be751adf99a0665ad7f5e712fda0417aa5de13eec5f2d2ea8a7f4327fd08e7329feec43b9bb70fb69e6742eb97fc1c22a2878346325ffd49e446d8b248cf51a7d18c2be2db808e0154f708fbaffc77e8cb0106ea3fedf767dc5ff874b85bfd770af625b0ddf9cdc811a1984c08b8224bc4d77a8597c5836e2af15c33ff054be553604eec45774441fbe563cc3e2c5fb474da3bd6ec725904e15fe1c359b6e35de355eb2929730276bc03e86315be2beafa10c4426e82bd3abe255ef5da19bbaa62eeb6488588f7df9a5a0e386c1c98db2fc8611a8809f50d50574358806ef1cfe15fcee7ce8b94b5959a732eccd965c9aaff2a447ea85bb331d503fb7f9745afd429f84c9722a741f25c82d73fc6f6027dca6f7116b9dd568a3ca559846720bda06d6f7cf4737b0eebf1cafc828fc2a3021c59b97e31c687c8c56a6f04cbd1daa686e4bfb023dd5fbf46cfae15743d8d2253bc817b64e09d207629f896eb060ad9682abf4503f76e7612ec0765cc2b6439138ff24d26d8c2b2efa682fd5685e1c287a3d12d0e454f51f47b74d5739255d81d9727ace1cf394180740dfaa1ddf9a2b207db4c8ba11e03b351e5895f16c9abe5f93637334b136a1a3ef202a0587991ec1c9ef97eeaf13508110753bdc192854c8ae55eefa98ced60a2e77d9d6f29db179a1241684cdbaa45f1b4fb37944043b156a619606a6ac462b69c468e8cd76c8d079f94e3bcbd4ee389d2ae0037faa50ddc1c4f8c68977f95e3d4498156030eeea40b0c4df610023a569e607db162cc488f4235491bd93402a9f2a356781316d55928fb262f8c31e129c81df04134170501125df4ad3da481d8d344f82f76f6a1d7c7494502cfe16e2b6ac870dc4115725f75c45b413970354d6a375590669adc016260244c092cf9a91ec55218059431bf32c0eda2d0fe5c23dc65c5317dbd4bc4ba3ed8ec65a97f0694cb5115c3490da83210cbd6b8770b821f3793345dcf921aec46a3c06c08b81bfd3f0a083840516b1ef5e1b56ff1558cf54bfc6122c95f3b87628bab0e3fc12d622f7abd80195c27e5bd7813333fcccbce194b72ec855faec89f75607ef59015fa6d916ec95ad903dac4feeb5ca6c91713f526b6647311c4a19866d32e12f17854532cf3a57cd3d5cc95b9c6d80123227f87717b84a20e58e86fc1018b924689e6ceacc6ee4d4289dc06e98e2f48d47d9ae6ca64d4eca37ee34d3ea33aa1a05e483f828904dc08760fa0009b62e9d955fa218b2c836931397ce2459cbedae11ef243da9230ad9766a4fbe0a91243ca96bb68b4bdc63700460aa305bd4bc889fb5ebbfa4b0b062047e8d5a5df3e9ffa3fdb02b8fed621c0bd09de1acfd7e4cc4f5000c6a1d714ab671281767b74008b11180e80a07d4cdf50435f46619d182b4d72f4979f2d737f07add7d0df58b6b278e08668bcf4ef97a58d8047619b5e254a944f59dd439e860034e49a984e0f72cfcd8f40588f5d7188a3d410aa111d8f8a7aaa4bc9ee82a49178cd1ae4042cf9067dae1e7d1f1342b82ea7ad96577c85441b1fabf06680b1ca8511700a08c7a7cadd67973cc7c51a5750678a93d9b2b34823f23f05e73621940c7abe4d47fc26b36d678dbcd3a48208a2faa5c7f569b37ae919ce823fb2a9f252b62c8c2f59779ca4956ee932c7550fd3cd562b55b29734533cdcf5b78af0bd6ea10e30923902745d4f2201d4182dc89a1993cfec5c59ee1ec40b6091de787fc48e6159b26be17cf57570f1c3c56b34508ad4b5cc96217eda0577dc108b08d4cfb1fc7b2cf95ac1215faeb3fe2d2ef06051604bd8f1bfb47b8ce0d0bf19680ca6fd3076d2d72dbcf6ea2cb57bf5e7d8c834dff072857b987ff2eb01255fc7415619f9e50bb1821e594574993aaf9dbe8e9fcbf47e130b0e572408956ef885e8f4acb1ebc4da49ede361b27b96f543ec48f112e2193765fa92d704ab8edef75f532ff5478cf1d3f77234f4ef26b85bf37e76d97ff5cae85e81c34b2ae83981b77cd44c45a9ed96d2c2b8386c5f132c4e5409350b576421e13a18878d7ea18214946fc28b653d43d3a6d425d83492692a0bdf549701cedaeb74ffad554b823cb84a4e2f0fa3d698bd0cc1cf3a985a02c6fc441ead5a7c9415b19f256dc4e0cff9f87e92e2e02eac05dc626f5fa6b9a466876886e124887be58ea48d42f1ab348e96e287cc2cdab26323a62beed20612eccf480ab8a10441f70deab9e4d16f8e035741d11bd78ffe44a69d431201f6f0292bd5ba6bd249b7a75049602eb48455a446b429281eff1d629b649b9501f633de8df48fb5405033179c02208dfdedb] */