/**
 * @author Merrick
 * @name chatgpt
 * @origin xmo
 * @version 1.2.7
 * @description ChatGpt聊天，适配无界3.0
 * @team xmo
 * @rule ^(aichatgpt|aichatgptc|aidraw) ([\s\S]+)$
 * @rule ^(aichatgpt|aichatgptc)$
 * @admin false
 * @public true
 * @priority 99999
 * @classification ["插件"]
 * @disable false
 * @systemVersion >=:3.0.0
 * @authentication true
 */

/* 
基于sumuen大佬的插件修改，主要是适配了2.0界面，按自己的使用习惯进行了一些调整，原插件在这里https://github.com/sumuen/Bncr_plugin/blob/main/Bncr_ChatGPT.js
需要ApiKey，没有的可以看看这个项目https://github.com/aurora-develop/aurora

v1.0.1 修复了QQ和微信平台在编辑模式下不能正常回复的bug
v1.0.2 跟进大佬修改了调用chatgpt模块，用got发送请求（虽然我不懂但是我会复制粘贴）
v1.0.3 因为前期搭建的项目有问题，调试的时候找不到原因，干脆把代码重新梳理了一遍，具体改动如下：
       1. 修改api的调用方式，采用ChatGPT API官方文档里的方式调用，去除了原作者大量的错误处理代码，大幅度精简了代码
       2. 添加画图功能，设定需要单独配置画图的各项参数，方便用户的不同需求
       3. 修改HumanTG的编辑回复功能，可以支持各种回复类型（前提是适配器支持）
       注意：这个版本最主要是加入了画图功能，如果不需要画图也可以不更新，因为新的调用方式我没有深入测试，不确定比原作者的got方式更好，更新的话需要同步更新prompts.json文件
v1.0.4 适配无界3.0      

todo（其实是我想做不会做，大佬带我~~~~~）
1.用更优雅的方式实现HumanTG的编辑回复和直接回复的切换
2.选择预设角色的时候可以把Prompt直接显示出来，方便调整（下拉列表框和文本框联动）
3.添加画图功能（大佬的代码已经实现了，我没有4.0的ApiKey，无法测试）✔
*/

/** Code Encryption Block[be188605b2af9d5e9f0e7db22a9634fc212a7ad0a1e72494f09b567ed405599e3a6969c7bfc1217e57a59f2120e0f9542850a3d41954a72effbd7a1d5c4eab4bf188beb4f3e3dbec38f4ae588c4f37080b06085c349e7e725519765f0d138b461a28ed42fe7e883b0eb70234cde01738624108424084077d17630ced0cb199a8171e6aaf17cf64933c3ef4c8b1e11daadde35f592c013bf37ee4537a95dd3a7c2b22416cf55052d6073c6cc14edab7803855466110136d0495d39168ff17210f637eea151d25d0dc50597a454de27e64dbb41f3ae145683b8c893dddac0babc5966dc4a16f79f8d2cb6c07be10abbc1e262bd4c1affa55a88a20c0aa53227762e32d45b69ad6ba4477780083e279682a97eee88f9741a4d4408a13b6e9cd42163c1e319e39030966deabc631d62f3c17ae03fbf049d5c41f18b395f4eef9a31b49983b1ba1c53cd099f431b57350ca97a3d2fe2688e26fdcbdedc1b26db5b3c4facd6dc96d6f5c5919830cc03eaafd4ffdcd1b9570e9ac39cda4514b7d95f4aa412e9f2738b57d5eda87a13231bb499b54df377e6030ffd6e213619abbd69bdac7f4ff2161ac82ea402b73cf47fb75dbe850d2e6ffcbc0c75af533920c9ee6859a2ec05bb5f7f63f8338fcf632888f8e48aa120efac0e3072bba6555ebec3b34269a481e5fb16b6abffea1a76e28330ec9dbf8a17b5069b63218a4eb674d9bcac53f4063345ed5cf1179c47bda1c67c3757fa8080fdc2e95012c212df07bac8b8178e4551449231f242b95e5d60bef7c6e4a5c1965eed5cb51b0843b04ecff5a199c1b4bb1d20833640b820fdf8e04dce7775788a10ad0019750fb65093b112d026a3afd43f944ae7d53f238e12f734ce843f94282ef51361803aa256fd301536a2b89978da0c47bc518fcd9e8536978bde78f070e5f80b55c64b797f1941d4144b0bdf5942e39a8aa556848756c105b64ab8d8d45666b4db26dd04dce715d64996371e37c2442889ead9f1df297e8bafd59b80064eebde6bbf059c0cb799a5e7ea4853b9321e6b98999984b2f1e5a091946d592dfbd9fc7d4ebf289e205bbc43acb64d7a6a5b6385dcd93e53ea464e3ed9aa03da91ce33c5546f6b948ea134fdf77c36bd91300aefdd79b3e9153e5550602d2f78394c01bf858a6a3872809d89ab204df428a9693961ce54384e43b31be40962ffd5fdee5e0abc8cc84fb4b0416f6812244225e59d6ef65690cbf14df6e0d316eec28a2f21c7aae7b5f985cfe7d9fc23a993ff37ed5c34c0dae6e1500ed2672c3e36bb3fbe147ba139547df729f8eddd8a47e8d67c4f2508d439b647fd1c897e19ec2ced8e077f39bc0e565d10a6727a17b24d51dc1199ab5214deb42174bf6918946edacee4ee09eef28e2f10d7c88f161ea137ce44bc43c39bfcd2fdc6f504d1fe0525d43d93946992562b34343fda69f47778e740300bb852a12412be4a87cf8735bf8271f59c93b803b3240a490d140566bf605c68a466933ef47eeea6a8deae051b75807b8b4dd05c336242c06e3088e743fae20ba888623268bbe06ebe752d210bcfa54fdaf1009d1cda1a82c6df46afa505e8a2dea71e6833c58c556617f9ef5e61601cc31d07622483c37f9b47fad2ffc320a615e547f4a8ad023dbc614030d6dad1e945372d9078016a2209b254720366ab3502f956f0bf6a46ee71da9dd55daa07fd90bd47435ba5332f4d21e4e3513f06469a3d5176234ca4022ddcb72d2ecf7b32d1515ee52d3942691e4ae94389263b7836cedbb0b057bed4940f98a64b83dfdfd55aea69a7b4aeee80fafeb7ac0461f24b3c391187d51ad8ae5560ac76b6b6df112f95f95205f6583ad8d9feb4690484304d91cf1f142e1c36dd656f9f7cb5d91a8796abdc8ac23a69f5d8dfbe86dec9040168419f8ba4474a940315b74a3d5933e7e95b35551cdfec4bd58fc8ef87ef9dce60e57af057edd902820c44d1cbc0fdd99b87ed76cd0ca9a9682b5b7c18de9c447f3cac41a1fe23a779ca0d695182cc06ca2b1ed241190056af5b1c2e246a619c4d10bdc39323a82185071b294c5fd3a75c02a586f4545df5c4aba1a22038fc9a7635eab2d5d96ebfcabdef6fe1ca28b80a3012cdcac906974360a1812cfc2ddeea801409176c34fdea0a077ef127756bae8e54b9c862bdf0971591967f2663f59cef35440c07798585c82e076495d82f77e6613731f21b3e01da419e84fef9d1beaa7cd8820e4599feb66144850f442e7357fcf529cc0f20f709bb8089b8f9fc3f1f32a8a5e773b3fea97655b7e488b0e79e8ff918238b42b19d85d46c12bca604b6ce00ec9e937c59bee0c1fb1c2fdb10a98d2df18788039a3d9c2d27661d4ce0480ce0ac25850f03f9c9e37161ff9a9b07fee3cafe84e6455f9e3708c67a377ba8611d4dbdd3eef22602494f35999638db92dcac3a219e2716077ce81295122f314b715ec62f720ce031910b8d5482bc3643d16711045e74edd6eb18f9056c5603208633e1da68de1f03fcf8a3ffbe43d0c15fc3a19727625683c569b042d0e70965137c71a3ebb76c211566e0739254645aae1a4659398e82c5112c905359d5dc07e38342186bc2b4a0f2e1f6a8286d1489ba95ded883c8484a359ce6a9e0e86898e4a1eedeee371c016268595207cde0316c69904151a5c1b9da04565bbd2d6f6466837c8fd9ab0386914c90a1200df7a1f4524a94687298b23fd4d51b0d5f0fed31143d956566e551afe2a6e8a8e70a755c6ea0dd1028370c00b4e9c02e516b1225095e2a0c9c9fe49782fd7709761553da70487bec882cff361daa43c82955a522c9edf06d4d3b3139245bfeeb0a25d3722dd43cd8fe3f47fca366274e4a81314aa881d772c925e796e8a2f4dfe3cfe1a443182afacb04db2dd4c6a62ef7e7b612f017334f09cf84f3cc32c0d5e2ea9eb3ef4da7c7e7f422eec4968651bdfce805c23c61c1a038c0823486159cfb005cc296693d5c26a7c408d2d95b47cda6c98011a21d7371d6a4272042972e708aa347b77698dbe39bef02db64a6d265a9156097405f32b187c57cae161c4f9eb9153a81fe5af3abe09f3db519b5a875863ab9c1d6805bd017fc97724cdb22b7fae2d40783342f59891eb6e488b3e45cc9ae937232360586e66cd88f4ecd6ab64b83559414525cf46c1d39b218f5c2c8e314227e8f2807dee6127acb90d2d18f0c578bededff153b1503c34498d310687b31bcef606ec4b532f6fedd94bfe13bdd36b2a4bb2958ad35e32fb0d5ba9cb29d0dada3eb0cd51a3f1bdad62c340d71bbeab0482abb5c2b2052e897aa5b1472d646e0e86d4187c9ef3db2db887cf308f2752fbd93e1b3f62c75436d970e213f767ab205030ba00495f688b17a4bf160c901df42719845c3b835727c46c27367e1cbccc054288703fb2c0f4ab4e13cb49f976fc930ab88693ce59e9fce2f1bf78934c201adb6f5b7ae384c46b015586e763d827337ccbbfd9a572d3aca6781cde4d435f767748cd2132c5b490c6a3b80a3d29ab9e68e6bac205c3a4c9b7c18f0c3015f58dbad6f07ed74028ba906e47031be0aba8fd08b4dc834e17706672e317ca1c103ed7eeb8edc037dfa4cb39548e062010ffd30aab66bfb0d46ba319567152478f8b06fc5ca572e2958bba9603d289719941dee7929f32a5a026a21318a417e9a112aad69970ed8c4435f45211a6fe58a0475ba29b4f316b1f62d2bc22d21d88b9e53d70710814cc2afc5e417f9436a49fbd8cc82b8446679be753aa04a14e804caaefc4bd41bea1395d6956bc3c04877e812b88d1c4bdcca905727b0173f2028aeeb6075660a2ada71d4ae43b5679783401e1103d18c2ca38aabcac0679eea23b01c0d6607f1064b252c8d0fa3d27b6d59a9748210e8e35a3ca2295bd7dcaf0651ff4f18399500f2493d73085f7896e90f8b8f5a2f730614a607ba6798817996a995e8edaf8d354e9fc96c191abaffe41953dc6e5e20a6b6140a7124a6eccdb85412532ba0298f3a76669bb03bf1ed7a93cbbb97f37575d235f4739d5b19d4c4498020f1bb17f3ca85d68cd6060acdd2bd4e5e26d4f593f2ef7e09aa80b812c4dbc924c3a333c696b73746a442bf30e084c63e0c8c60766772106d3fd0ae2e6a91c09b9bec5429b6d13db4ff4ffdfc8be9e9280061481f054348ad0847baa5d387639f78cb344330a5ab751aa90788446929c3f25b1996716acad7c2e44a462d4fd8d9b9df184b1afb063f36e4aa9974867acdfe0f688f8167514690f879a03dd6961194f9087b2ad91ce59ca0f2ddb4a77e3bc7dd8b8bc101160b1218055af14dae15ff8717e84977a6f172c79a5a189dd26190a5b47c6ead4bb1bfa715b719fafd6f83bae2e8ad59ae5a247727f8f67d84c12da9aa51c5147e1f0bab5c9d987db00e740551e64b62214424a221f0729706795eaa62df604f6f9ee9077ea363abf6e45404fa6bee49f496f331d85631d0feb08c47a75d204e8da10eb86e841e3de737458f960e2d5175dcdc408257ca392bcb2d8618186af6e42407b8752f15ca9ae4387c197242c4a33384f63c17f7d565a7e5fa43824bd82270f9594a3b13ae84ed674e293daddb75d48c77e6ee3d58f14f1352657b1899dfe56e777c5b42bdb801df5fc0d0425b39dd45e074112199690de8d161e52268947481152e27c8731ff85946c75c684f7811768399cac49af1897168581fd8f6dc59f3a1074b9ac8ed2e0d3265dd89dc9fc2c016b6774613e5649e39f4b2fdc00ef615c208bc3d71d8fc46392b556597bc15758e23e79ba8d8da0253788f221438a2a4525b106cc387da0d86b02eab7e33c53aa71e2c5a5a3971a7dd169424b88124d5979d1b5f494c3f8cad98a968ed1317da9a49de1bae1cb0bceec2e2cc38171385341ee408a893cc76c204a5f5df74198d3677c3ff89e2eff015c02ea81053bc1f454152b062990ccb69dc92578815a04b1507ffa838e4e27e6122bb5c35a8416517a185a11d8fe01d0bd3de294d32a9aab4234849f0744ac2566b60c48cd992967fc076caa2fdaae3e637adc6692d733140251dcf6811ed6043ffce1e58f4e5927ffab06a7c7e26aba5c6d6fd0d403cf32ff91c30f5be8330ab2a2fa781404e9bc1cf1de857599366197aedb6dcf828df66f913ef720653d4de8dd5e3452cf4f68775a4a9fef8db734ab35e39e88c5de73734c6c6ce699e81818eda392832f3303dbaf585d238ccbe8f3eb4715843cb5d3993d3f80b2c00264932a108efd9e7213cdc79720ddb617de8a3f2c2b734f55376a6accc808d2ad16878386816daada222e0d0cca01a6c710fba0711241939913097df43b30c36d86185fd6a1d3cec74527e29faf034052f869a7699883a4ac7a5f25e402eb29b5803610290351b419722fff0a38083f00d0714cb8d32e168f6952e7b781b989599caecdb18f8b7bf40df2e951dd7e14b06230622c7178df217a92056545212623d289d5dce4da164fc14e4135581b4538423861c874b6a58c63af55d07295640d37b99066c3537fb8d661f7a8944b3a0191f6c221caa7b9feb0f0f422c81c07ac373f3779fc0a6a1f766ca254e683489aef8d3478c778d2818eee3da7c3d7eef93a0123c37e134e116eee22141be8a366012ae46b111eb2c026c42159276c09ed679205ba4955758be9f4e64a4a3862b102d04b7efcb8668c3492ba96a33bba5713e2a254f8a57d1fe15ebf01ca4f9f0671523d7216fe4c2e7758714e366de0ef23c6002b7e49ae59f703f0af6af0ebea5c01b904521312597dce294d44d8335bcbc6e41ef9ad8707f1c29bb1bdc13ca05a53239fbbd56db4c25a9b868662447b56f421115f1262578a8db2e48e9823890d00bbbbaa877f4768e4d6a70f615f408ab911636490ca150732f37e9762108040c0098bcff43eb07d62bcecc4c0367f5bc6001ba9f9649b04e64ebb9d50d4b29b6b8d664948b73fbedb96a30e58d97f9ee30724c5422d18627c7a021cd5da7869ad3a47c293e481eb6d2884b16df86dd9fb2650ce3ee1f0fefaa3612c068a0187839078b8963e5270e658c74f9b7dddaae730727a2e4e0e0b8e55acffa67c2aadd7a749dfb2e6d7e4068754916dfaa6bb8be01b5357dfce7ece7bf9a2b90c7973e8177512ccf9156bbd385217cc80140a53c42de22f835a52e1b2d8bc4a2c86f73b09e9ceee508b262e1dbfc4539dd7bbb222933b63c4dd54c7f34d0d7313e7119ed2ebd1c9db35f1114f3039342fab160e565f7b2c65d1c233dc31432d243f6e57bfdc9eb541e1ee8404945fefed1de2ed59f5c2f632f80c19b8bbc61b3df733949a22b80952d1bc14746f7c1a707a452b8b034b06168b3b51fc766625a33282ed1b3bd3327e7a8786be3be1139f6a78fe77fe56d4eda0171d6f3add0ce19d2e96b4fb41306cb6efde22871f6157860db33a9c057b480c9aee89e7dcb880d147f1c09c40807c6e4004c3e6f6f694378072cd129f8429653ecb27be67bdc5a249dc6f6dd51b52423ca0514e4b35ec144b6a27c771c77ca30a21a6e32c21ffe0079670ded3145bc9ebe7766e39590b40a8a49fa908be5fed7bc9cd9cd1dedc5a78b0b3f6f3d2a51e86779b6640c69239298b667741392a1ded893405fb9e1e7953fba966aaee73ed67270b38dafafae7669162cf178e0cf2a9daa037f1f4211c9d572ae2c6eb943b7f8b28f0548f3df2216ed47e146cd352225ee027fc725b9298331c752795f13f0045eafb7569847ebba9603f47ef4bdc03eddfad3b35725cdd9f4c3370e7369a9471c8537c740705c285cfcf7128c0b688dfbf1ed2b7e93af3a57637b3fa491fe6ea5e05ae70610b8ffc3d22d2fbdbf686c325c90a8b69044ad2dd4529eaa4d41bb1627ba47bc132209419a8f85579ef9a90181daabb947c169ce68089f9c415b1e1c0a326dc4db875a7b5f937323fab1b36cf41eb30b73981602b6ed9db4067ee46f6d69c031da92b87a9cbd5bb26f02632a2ed291255c979c3a02ea18947f0fa98985f8f6ba4fe06b02507e836cad8eec71a6e66d38f92e6e4a81c67f0bd5fe10b2bfbedc8d46c2ad9616c49234473cdcfba87079e882a4c488f0562b98100598c7cff4020c9b433c291bc9957d9b2aaa3b985d712f05e9819b02503389c99dc78b3dc55ba8c48a3c29f9681f0020ec0f47f13fa64c23760584fbd86038aeed9a7e75e56ab1d9887573ac55b724533305330b107b02ff53ad6fdae84d661df166474695cf344b75d95aeea8e891298fae82996cc2aae511f9a85d9ab960ce59285a202ed84e26405d4f02ec03a78ced9dfcde5fb8edc319befea985c70823715b0410363c15803576b9ea64e07f5f4212fdadf3f1eb0acf8a7c896037f754d385f0a8b0b01140641b0356688e46aa9799a1e495c7ea5a2a9b7a6b817d99f12edd1ac4683648402c151afe826e13dfa990de085d79f85646a242824ed785e671125999391c4bb7a55d1ccaf54a1abf46ce20e2ff743bc610156a01eebe49b11faa5ee2ece5364163668eea4ec6ba4cc76dabce83782c6130f97956e5bef1fcf273701c939ea4af44bc6e7d39717b28a83468f02a44850fcb0b25b22f408ce774c0fa61a258fbce54ee2734dd7b19218d366324f02dd05202351ebc4b7e895a8942d27f552460a020f3502f095c528e80d40b7eb8b6e443b88eb543bce4665f5aefe9468fcf2a0b368348f6304d19444d318f51ea6a828f677fe92b2ec47d103790416aa5865bc513a09fa8f1041a1b7a2a673d3101405d5706600e09074c156fc188ec06b23c9aac76eb49b0284a8ab750f5b71e300e3213e2c8facb913cb074868766e69f5d798507335e78ca0a4772faa6b0e44c644080b526302fb98cba88febb841b36f094b44a063e4178b06e8d413ce48e0d7ac075221e7e7921d52d41ff2ccb6d950723ba84e670c16133b47a82d8b1b845e18b96ef8e4118e5ff450c0ec9638eef62f41688f98dcab3f71a8462a19ffb4d3a87bf4f820d7e4e85f0cb81847cd456e35ec494aa1a06af896a3014a9843735f033cbe6910d206ee39c1e6b1d6de03458539cb41b86d456186d4a0b5fc9a5b639f77f2e76e0f07800ef1c64b06b74bfbb0c8dff30936633f2b69144c7055517d1acf2a7963f1b30442f7da3edcd271911b66719818b13e028cba130633af41828cb8e773194f75465947b9ac573f60ce49b343dbe1a8820fc461866cba08ae321bb536259d1bfaf97a4db74524809990c0a27e46e510b7f01a0215d89d02d3ad3ace77e144da58baa728254eb72ae0372ba47d63efbe7d14849ad5b8358991324986f718a7fd7177b10998f503eb9c309e9cfa9480050ca8d0168edca26bc7f38b0ea3f9597e104b61d4499de5b3997f95c26c7ff35b6cd37474e3b97f0513f2fb90cd76affe833c935c71412ed3191e6b017c136229d075790d12aa8ca586532ced39791f50a801e4e710811d5c0bbb1af0132db63780d8a2e447dbb11da9c85f53fdc50e5e3e86aff1123b04601bd45fb8fe99aa7d0c340beee1aa4793a7af763f24400223893410a223e381648ff2d9312f677007e122213af2104429df91106643ee34dbce54c8a0fce6deceb37150b2052408c0b177a39d85f2ac3960239a973d59cb9c4b86cf5b750c32e9ae337ef810076d9b098d14215f0d54bf3a759339f51b61d8783688dab84141d32133a5fe6f1b61c1fd9d76cd4ae0710f5a1b0cf943ead7c8328c10232a85b6cdb00990f08fb7d6f2f35ac0ae4735358514a2fafe9210ab88d60f51afa6b45566] */