/**
 * @author Merrick
 * @name chatgpt
 * @origin xmo
 * @version 1.2.2
 * @description ChatGpt聊天，适配无界3.0
 * @team xmo
 * @rule ^(aichatgpt|aichatgptc|aidraw) ([\s\S]+)$
 * @rule ^(aichatgpt|aichatgptc)$
 * @admin false
 * @public true
 * @priority 99999
 * @classification ["插件"]
 * @disable false
 * @systemVersion >=:3.0.0
 * @authentication true
 */

/* 
基于sumuen大佬的插件修改，主要是适配了2.0界面，按自己的使用习惯进行了一些调整，原插件在这里https://github.com/sumuen/Bncr_plugin/blob/main/Bncr_ChatGPT.js
需要ApiKey，没有的可以看看这个项目https://github.com/aurora-develop/aurora

v1.0.1 修复了QQ和微信平台在编辑模式下不能正常回复的bug
v1.0.2 跟进大佬修改了调用chatgpt模块，用got发送请求（虽然我不懂但是我会复制粘贴）
v1.0.3 因为前期搭建的项目有问题，调试的时候找不到原因，干脆把代码重新梳理了一遍，具体改动如下：
       1. 修改api的调用方式，采用ChatGPT API官方文档里的方式调用，去除了原作者大量的错误处理代码，大幅度精简了代码
       2. 添加画图功能，设定需要单独配置画图的各项参数，方便用户的不同需求
       3. 修改HumanTG的编辑回复功能，可以支持各种回复类型（前提是适配器支持）
       注意：这个版本最主要是加入了画图功能，如果不需要画图也可以不更新，因为新的调用方式我没有深入测试，不确定比原作者的got方式更好，更新的话需要同步更新prompts.json文件
v1.0.4 适配无界3.0      

todo（其实是我想做不会做，大佬带我~~~~~）
1.用更优雅的方式实现HumanTG的编辑回复和直接回复的切换
2.选择预设角色的时候可以把Prompt直接显示出来，方便调整（下拉列表框和文本框联动）
3.添加画图功能（大佬的代码已经实现了，我没有4.0的ApiKey，无法测试）✔
*/

/** Code Encryption Block[be188605b2af9d5e9f0e7db22a9634fc212a7ad0a1e72494f09b567ed405599e3a6969c7bfc1217e57a59f2120e0f9542850a3d41954a72effbd7a1d5c4eab4bf188beb4f3e3dbec38f4ae588c4f37080b06085c349e7e725519765f0d138b461a28ed42fe7e883b0eb70234cde01738624108424084077d17630ced0cb199a8171e6aaf17cf64933c3ef4c8b1e11daadde35f592c013bf37ee4537a95dd3a7c2b22416cf55052d6073c6cc14edab78009a388351d452c06f44272ae84fb6586c8ed5b4667bf2859ed80006e6f9917c97962b44b4a62fa01dddef3e2a2930d71e9755cb394163dcf128776391432d9525a7969cd380d0c6d88bae4bbbee3038b10122f82953c1c9fa62366e3c1d6170f2ced4177eaec63c5a149e730c86b5de4f29c2a714d0d11abe211c90d954904b82551d27a18b3fde5e9fbb601e53835a0097e3169f1925726c1cb16b835c2e3f83ac46f82b1297bf9c9aa3d0fa10cd692ef82c6d3cb9cf4b0d8464b60387e98bf98b25fb58efbe0cd3c1f810472f4c82b2e79c1ca9a8d7c3c90ce8b30af216434185db87dcb0226a72e91ffbfa3f1b28e4459620794e7d1f78ab736f2a3d7b7f9211e65502fbe59ab72b2b74b121648eac744182b876e6260875b24445f9f6a8cbbc4c9f1af4e1041e3a53643fa9baf97a3e17b3c60b91ccacd3c1162163a15d69923c6bded45258971353c3608d10bb638fda2f26623e9149b22c640580464555872331f70a5248f0b11b9e034b2f09d3bd55bb2f89c345fed47288f6e9029f0e653bcb2145326353cae3898545f3cdedf38bf0b3d3f1d21e0c51f85a0e0aea30a2cc3f253e52b8965977d48bb7dd957f91c8ad68b8ff993445a1dd216305a3b411580a21ed1d590403db80463b776a0527067f93bafaef7679572f32ab4f40aa85179cadbbf4a30a866c165fff6d7fdb6818800b3d2f846015fc5615fbddf8d1a30cd1a18f3b84087d6fc8a0bf519dd1b3065a6eef5f10ad0a352f84facaf4dfb3c08cd9ea8dfc1bad4e0813c834aded5c5183d616e8bac94a4f01e4eb79f37f701af4a458e5bc986968eb0c79637cef68a69ea255808a7833c324425904dc5033515e3b2b6fd375bf5c205fc0b836efe4d1addf27e881f24b0c65d484d6d9d306fa3c83f724f9b04241f570ce5b90077a87f89406768b95ae39ad1cee9c5963ecd228e7a74dc48e07993668a22f14c0189e3271b4679a3fe32a09e9f57026e541f0f36a54ed240d3317678fe13b58049e9da46493234c5b0d83051db38a4f5e851641616017557729333607753c5e339c78a767b21d9e06b6f540503b6f255629ebfb00f92244247c58b74820f44cfa4152b301457062c1201245bb00991d92629ea3c9cb0bfb14e8aa43089c2d2f0ad524414821b9a8103c09f8e889c04e83d4314e7bfb6588e33981bce8cdb2c4ce623a06f48950aae4519a684d4a7aeb72091215e69c6ff370ecd667650012b97c3094814a953d8f462a724d575c42b93c38f76177fc9a8cefc577a7606072d9d77d5532dc10d85cb2ec85b030de15e54247cbf40ea65553ece788ee4d51b8188139cacda59ec4c79d2853d5d63bdbcb3a453efaebf7f8486cf4c3878914839d03fa3a40b547486cc2e4ef3a4e644717abe4fd714582855d141d5323cea92e1708b26dfb9e13e56daad7a61045697a7b68377e215575da0bcdfcbf04ef6f5e128aaf6b0ebc5e7638b47ccbe180f376c0254197a861cc75610dcbf79dc567c4acefb2fcda8f4afb3690a3a0bb82462daa140a0d16df76e4d84dcbc4ec948606d71d18fdf51bbba3067dde01aeb55364b92d2db475c32a6ad6a0f4640255668b98d7f359146bbdc95b090d7c9dc00c4cb55a617d6b419b0fcd9338bec97612e41a555a56e60bad459d48c28a462a24e7547680875fe9ae64819545fb3a17b61f1f540f22b7f0c3e29300cef102d5897e0f29177fcb3470436ffed08fa8f1c62f37484f558cd97ab1c4adff07fea5ae949575e2bacb8dae6ac8756e17f44a177b0875287f7586be8d55cc1ba21809aadf6ad8283106196929383a8bae053dc058c56b7230e13a917ffa7bdeb32898f8ce34d5d23bc2f056e649e9d7d6190aabe22400e13ff6cf8028555a2cc0607c3f0771e4b76cf59486856a4fd4eee7d051fb3d72c08c57b512c30f5107d07cd63c2cb8e3d0c9164eb99dfd604262f7bf1d493d2e9b0c2378d04935119959d33edce7819d01f580d64339ec5337a3f457c5996e25f54dbe6c3e7abf62bb9b03d68bc168517bd285a0aff196ef58b4a81d70888fecca050f90dece7e4da7c7b86bb42a1e1d3fa6f7eb5099395f40d10b327d3ec04abcd768c1be886532a5e1aa4164c8ac6d648ee69e4a926289e53e92d488d6dca8ab6eb0ee05045b60b18e67c1ed19260dd20563b14f491f7c4499ab19770ba382510140d08331411e6f2301e85e5978c548e7d711f15638f2051ac73f1114217e1abcd35d71951a3efb30b00297d47cc01f5e04634c78d120ffb11abd574964ec0342011cadd3d17814595cbd192ac2bec76b3802ed31ed4774fca9811ac7a2f59765c6a2b7298770019433860a3c07c36e78fd4e318debb45ef5f49abb8270bfafb0698aceb686ab93b764b3c4b7659f6a891d91bae970f76937af0bb9f10dc35855f1f06be7a3422117888514204acc08017def76a69bef5649c496fd0877196c32934bea4032988e24cf68cb8e602a10e4f2d31607f41a66256df8fe5601ce1f3c4f775612015f23d6ffa23c80cadf243769beae07b450c2240f1d2de564146279ad480c12568004e7bbc2f212a97372418b7f11ed7adf4c478e22a03edc19d1a49dbebb97fee80bf7a4a0bc1450de196dee074bbe8a95050a9ebe10086de45aab82ee067d1eef8c17656d9e82a2c0c5c12c8e80ed98ffd024878fa1c98743c7002458d4bb81bf5317c97b4478c3c16aa6c6e2328c6368700ebfde1146bf562d38f3d33c97bc7941dbe05a2d1e9af4b7a58ae6d4761873b8ca22ab8af91e0dd459d6ee35ebbc7fd18dac697e9d0b4cc741f56b5e73f42498d8bfb94963c53a61260134d2e1c76436997be499438a44a7b3b914bc706cdd9b583fbf3d139cad91a373736ec8ac5d0b59dabe942965269dab2149c95e5029ceb9995e8c0a8782fc58ba82e8c426faf0b126cf7e60e888ee7bb6f617011d1b34aad092cd23cde988fa9a12449fd44d9a21a060947b6af536add95a368a323340e8d9d1598156f58ba009ce501320265365c9b39d01d189bb33566277251ce2222f6f85a2190151b0dac98250c397fb7e422e34e91ec3c29aec1f2d0ad2747f9f9c2a469903ff4b1c9e92077f25fc6103a862e70e7de2fa85d20cf22fab2b26ee71cca2368bc1097cd89c541e5974fa7a244051ea8c8b102d84ceb3f65703f2280376d1982512e08c7647473c06e028704404f6e78fa3d67a15f528ccaef804dfc128a0820d3543f439bb1c85264cf7f64800a0cdd144edf20672cf991cf946da90bc04e289072dc350611e55381451b693f40d6e830ec353646daf567e03a09e57e2eb45b1aa265df683c70e2b42399a904aff22a7d4761b6166412e02990a162098d026675a878b92a9ea01e2b7b7d014a51d5df72dc0aa5b7024091a815736ab6438cadfdc3320ab2f6e9b3a697ef47aa1c6cb42976a92e431cef36730642dc975d37a717e6f9f717a2ab167c9b770d42a5370a03d7eb4f6f2a293f13bd26cc9e7f0559cee6b00ba6b93ee91e8ae9c7baa1635364075a94937a0742dd009113c63d80d6748521308a2e21e02b14a75ef0ea855dd505e3a95f6fe22c4dad2dcd834048ea23c328aae83cd00f015061590e78f21e7b8e99b5352cbd815245bdb65da9dc2bea672e8aaa5fb4b0fb3834c09226e11e91f1ac9ffcf3dff39e7afa0eadfc8b1e3868746c2bad4711abdf00789103d544e2805ac05f00c6c4bfef770825ad25fcfe8e99d310bcaa7fbba4045044610c5256cfb1fd3c1d39da3122ed9b9e2bfb68dc139c3e72f00991e1c16557509c40126d82113301b9b8012a39880825f0815e94e587b0e7f287e3e5e95efa829445efd8a9d7221edbb56c8186ef4801077eb7c6576c423bde49ba2e2f1b19a164c740fbaffd8c3eb2eeb5da9360c72723bc1e8a580669fbb80ff67ec91cae0d870b269b2890173d11ef6a28127a7e71712c5aa15eebd787bf80e30b0c36446375a327b63c551a7ae20ffafeba162bc3d7d4a9b1a67502d24d42aa0bdb956a6fd4503a0aad4b0a51875170431cc0af803eec14b45b17d448959c8319cd9f2305701f54554f99aff9e1a7067a2ea47f4e912ec981559d2578c14fc9cf8966922dc3a1f72361f13de5f3f6c2bbbfcfe175ab2e036e12ebfd3ebbc6a57ca7e7e5dccfa7591cab7f8c375fcfe5838896bd69b4c32475eee4e6149b801d86debdab209a31b989913cfe47d7fbc346bc3cd811909415c478470f023297deab246ccae5ddfb4c0f7062e325e4ce48ed3f4539f551ad089d4574e40eff29a66736461066786992a9c238a4590ae6fb0356f5b6ac95ca4d53936337aba65a7794e98b1f45116754582e77e837b1800a761485d6bd9275c31ba56399c648164b3bd38fbf77e53156cc1a2061297585a2df9b685efb89e2db388890e6bd35b04db3af626deb059fbb20512b699d5f23691ff622b7ea35248444cd7266c0411a8f1affbdc5decec520ec878a4c0dca22b000c1ac93f70da07f01f35715d1b6dd25ba3aad22f682a6d29a40ebb6b99b096020c95e66c477419485d0dd2d162bbe85020be3da292417b7cbc444a3203c3c24bdeabf6093bae1f32adf5c5569c94d3b6789d6f118164584943820798846a35a02877ad6b9c183544fabf201c87fcec996f085f561c7cc01806da438ff3ce7db6e7f110be9eba95a511a10fb29d8fbe89f9e3149176cfc98ed3d4e1af82add4007912324e0bffb8b4e8b9f210d4155c6ded55e0446cf2c8034ea89fcfb678f805e73a2c2f230467454b9195d1a6028d6e1c1ce44531a693e7846a94dc0027c07cc85b63b07bd1b12600fce33ced31a282d4674c1562a4428ecf339a31fc7ebcd21b7d93e1c4085f80de2041c5288aa05a0a63456475c8dddfcb9fd6f3ba37ac9e200dfb01390d6d8f6e0f875be49d82463c05ecb5c77344639b53d7cac2f6ff62d4b9a68dbc24f27fcf16df6b8752f6f524ee5f25773d85c8b2b7ac7230b010c743f7bc5c57886191135e3409fa98b23bdafc6f85c90d910262aaba3b0f60d8487b3a2711e4d9d66e32fd9c989d7ad07e4be83f83ec6c526840b8c30860d20692e301249b634fee1c4f010d7ac5f76a744db8233757557eff2d97cf0f20a790f756d81e039c21df80aecf45f3be27a0247416ee0674fbfb86ee59b60f4f471583e53c5a7af7de33e2f45bc5154e95e6eafe48492d873dfe4f8aeeaca0eb0806744e13db04cec5d1b806ce86cdebb993e953aefac60589126f9e34182193b070ccce7ef0724dbc092d9f2165baf728519113f418723c1c244f01e740bf3d3eef686c43e6e2fa4a61040fb0acfdf9c41025c96a34258e6511ed8d239b466c82b79b81d9b12fc070419e6ff5af42c0cb1be9dec3498c1339358f7ea5f665386fa1544551ab7e445df78ba673c991598070c4a84c0f158d05654c08d2cecbedc8795bbd0c1e2795c72049083f05ff49c4d15d618ffc9869109073a18b937b4da0d3c155613a0c080a2f4009b1739692ddb6a8efb737dc3afa70c691a16355cff58ed6de32ebff188a91041332db76007b41427ffa9d83210992d2fa56336a891d2eef7221404951365aaee6b4fc1eb4c294963a0c998968440d896be6eb8f765a962f3c9485ebc1c85baf0eafa7756745f568b02aeb89f783dbc8475bc6004c22e34b3ca708617894b16c4692afedcbbd76fff2628c5b029cab9f01431ece4df0396e988c4dc5dc73ba3ffd2e8d3c900f8c7b79f163e111243c98397f13dc033af9b9431db311a366f2e224005097c00019db2f334d425056816a6cd01fc8282e21985144c786bf9456d353554d84c39946b57d0ef41662a253deaa92825003bf1f7d74faf490f8c34ae31302dba26863e423e263185920c2135d636a747b4cd318766464d00a2f24c4161e88afc84ef0bef6eca1027e65bc51c75d4b4e570d627b1f2d516250d1d2a663e0d93880fd8d32ec9aaf62d5de8c35256c1a61bfecd1387a82d13c01b40bdf099471413c0fb1150f763761616a900d4f547ee7d99fceff1c64724e4481eec89f80db2373ddcc2061aff9d7223895efc439c9b34e1d367ad53dd0dfcb3b0798df57ad4638ed7ac62a6ea97b5c5dbd5031ed1f073319bde4afa1b9cb646491ec5a529cbd5b518a0457da791370bb68ba731986802d8f9d41f85c002dac3703b6a47b6fdad9a20a9ad8c17abb7c26850ce9a1b59be7d8dfbd983c42b491207ebeacca4bca6f2eb83ba685f84578f2eb2ff5374360d8e78ad82745e02b0f9125591c354cd32041c2d06bd06b1632f8946cbbb9d873bc1ad186c1c41dcbde5314ea52358c32b67908a6dd661e146b49934b141b9d2a5c0c1184c6cd18c63d49d2390819f7aa43966d0981e1ade09356cc0d961fd7edc8fef93a2562451767e793f18644a9b420a9a9ff734cbbf83201593b737be668582a8a81338f19e272b808bf691fcc308b6b01c7503ff9289d4a033602bf3892747598632547f9b245c49c78bdfe463d581e6d829d6c959f5a391002f42bb44e6e95209bd807a475cd8eaca8de546b989d2196586e2e65c8bd6bbce25988428da08e56f056a00c89a1fbb3226cfb23ae371d99092922f7a1656e23241acc4781aab29d7f11b2cec386ece1889334aee444b398298c14da6930e236c0ef9cb67aeb22021f6757971f8c98efe6208fdeab8a85c30dba4c7c65c0956d4c0502cf7de19d0d16470561e2f0b993f4bb2b8db149e3072bfd5d2c8613f21f2036665910f8ccf0d27a84630e5cdc20eedb68687a1c92383d7a6e954dc96fdfe2ae7a2ebc20634e941e6698cd4b735a1a39d5c4a332f7b60939c4fde78cd388d633c83a2f5024e0f88e0f51d4c39323d19925b2a63b601a570e27a5ef901a1f6c1bf424116588e92628453c1c54282e24d53a2ef1f382658a6d9d34331eb46732ea7420c364a14932ed93dffded7b68e3e982fbeb1333b7ca5bd7db5e70ae61eb39ab41f3f5ccc754278b5dbe5a2a1ee4c7b369d84ad27814104b5b687f5386c4addf778dd4554a7595be17ff09d293133dcc4162964d7198682c3b5e7604a029fa83f101ec73dbe537fa44927f3208196ffd478875a2e55b2bcaf9c11b9a9c769a56e19b7f112bb37ce3ead22105f62e762531c0a4526198a908aad9f665c099b921652e58086c6247aa091d2680f1e05ba12c5dfbea79d678c7b4471eb9080fc46ef5e504c8b0904920893b4c423250dda60c4f8a8013ebf120769d95a175967ec0365fc8b5e48e3b724d7df88e890858c3157244b323f6fe759c9987e4915ee5becc8b493cb57352f5ce58db452ede6271c836844e05d0f065ef14b471d25d0dc9c018debcf2e979b1c19adaac15713c4d5e2138a89ea06fa98a36b9c59be14cf07e9f256e73b665da357415d20971ce290215d8a9aa3e811dcc6b4bb5447e1ea1d777584b8e9f958de3a0758fde1a39036a33b4953ff0a7bc9b092d5d879ac9a7a6b898f7cf6d0a7329b655fa35a76275b2d3e3ecbb1c5506cbdd28cad0b6f774776bfaf90b35234bcdb8b34f200b0ccf19689a46a1f70535b496bdb57b21514d40cfaa63dad8ce592fb0288b8e8ae0e46b5047db080a99eb29c1d64eeb3ab5373ec78a3780a581cfac080fd43b7fb39817aa20b90fe0bf384caf9f83ca5e6124de34506d34bcc23640ed4dae7af7241e8e16b44ab2be96fd405523b3d332df013a0d24c53e0842363ddeee64fbe2f6726e2cbe84096b14aab9b2a4a067cff2fd63cb3f79d43af9d6ba1c7fb16ab4d7501b2e99c5740d05a0660bfc2d439fa11360834e17702e1dfdb6fe187559ecaf1dc5885a4bca10a9a68e2193910ce242eac336b512d47c8b060b79b0d4f190cc83075b16e92f2a54b64ee334e61f10458dccd14508877ee766f23a315821e33785d5f86e35b8c6a59517b49b9fa7f848637cfda554a971f21cf4998ad47f71e88d96cb2ff57ca44b1569ce8f1f8317c5006763e4cc5ba9294fb3ec4cc1d8f092fa5b06127d1ab19fe5038576459c08cdecf5c0b8392c15880e4c45122968d98f368744cad11d6f52d02ccea7a5ba59a6fa18ac67a039f5f0e73c53e89dbe19fb6306478ac9a708f0c7e3239704bdae14b75125067be3e4b6f24322350670be00c32508392fd93aec5df5abb0ad985cbe268f6bfeeb66000c86a8baee256bdbc4815949ac93916b13b2d99d5b481669f1ab2eccec45c57fce387f42e4106ca4df6ab49c9363766839896cd0456d49d7cf059cb75008271331d2d135b59735407cd8a17bee627b9dc58442ce076b56075e5e2a7dadad9b9343a8ef3e19ea6b26837c8f793f5b350d0f9e1573f34061f78c437fe01264f825eaa14c6a23538f278e1a14485e04008dbf430186b43ac28f3413da4b8a1e8ebfd8d9cc4f264ac0acfc0417d936fccae885f403f4b4614ac322fba154e9486217d08588c8d9d7b14b070a3be56321dabdd1c8854ac35cc4a6d05d36d6bb8b678d85a49c1580c3d5d4136d13cfc8b6e723385828487ed057e80fa449da9426cf13271fa561dc10050bf2959f7f17422073c56ee672c65ae79680b007b0d1eaa85cf80768e6b6891778b35e4e5d860bb2e866128a573e63d0ad237001885df5b70b9480ad2dcd3e8c9ce106a1698b718b3480e8133fdbae67002c208ea882dfdeced943cad1a20ef9ec16131c8a1082e03ed3c78878412845eef5b240c31fdac3577f48feff3295263819b41f5ba05ff48a5aef0b2797617a2a1980f69fac5e2cd9420033634140082505fde7cd7a9c6cbf72267a5c2699be5e7f7db5873c6f892807f06f016ed3f7519dc44de7af83c548a8251d62a3bd539aa67da2296add9d3fc965276ddc185eb59d3aab44fac215bf095de4f96b197b3fb32a3f18522d1283f0f9aa3e44a0a9752d96549899116184ab0e6c41aad0eafdee091b39fc468f26526c106d37e9dc29d922235e0f43d3736021ec39cf65774d5a2ab1f67d7bbff380f03bc424ff4a78fcd5a8849a925b4168710de8d6854f0114fcbcf9c8f594e2b203928ab490965ea915fd76bd1d7eefe4752d543492fe6afde591cdba8ebd0d5830b31160efaa2e5fc097b6b6dfa785c260ec8d0471f7d46324c3576e0d60cb74292809ae88c3d64e73a5ec0932157ce5c610535cbf6cf6e29da202f0b2ef0baf77ae123b9ac3c9f59cfcc7e7aa507c6a41714f7a4b286c0a831937d07f65dc97a5539ecc3912c605ec8ddca01a8898ef6732789ef261d7cd8bbac2f1c067c53f1e5b8997fd1df358ddd48378c4fc6e8e3bd4301de52bd5451b008c3ad50eb437acd62b822b0550c5289f096969d9d01ce8969bec7f1183d0bb25f9fa5ba8b0e128aefd8be20b931e13d7df982f589ef981b4cb05c7a06dd9a91fa0aa8bcf93dfbe17d3c58e18775eb1093ca1aab94904f9cae682f256650810c9851152802cd7e2999aa4f6c09a3e89e69c61cf925414b9ffc19625223314c84b8729ae631666885d2e88d33ee68ab92b9dcb8041291d874efca2c1df5efac3faa987a21fb22896ea0349822d3c92584] */