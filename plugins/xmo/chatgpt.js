/**
 * @author Merrick
 * @name chatgpt
 * @origin xmo
 * @version 1.2.3
 * @description ChatGpt聊天，适配无界3.0
 * @team xmo
 * @rule ^(aichatgpt|aichatgptc|aidraw) ([\s\S]+)$
 * @rule ^(aichatgpt|aichatgptc)$
 * @admin false
 * @public true
 * @priority 99999
 * @classification ["插件"]
 * @disable false
 * @systemVersion >=:3.0.0
 * @authentication true
 */

/* 
基于sumuen大佬的插件修改，主要是适配了2.0界面，按自己的使用习惯进行了一些调整，原插件在这里https://github.com/sumuen/Bncr_plugin/blob/main/Bncr_ChatGPT.js
需要ApiKey，没有的可以看看这个项目https://github.com/aurora-develop/aurora

v1.0.1 修复了QQ和微信平台在编辑模式下不能正常回复的bug
v1.0.2 跟进大佬修改了调用chatgpt模块，用got发送请求（虽然我不懂但是我会复制粘贴）
v1.0.3 因为前期搭建的项目有问题，调试的时候找不到原因，干脆把代码重新梳理了一遍，具体改动如下：
       1. 修改api的调用方式，采用ChatGPT API官方文档里的方式调用，去除了原作者大量的错误处理代码，大幅度精简了代码
       2. 添加画图功能，设定需要单独配置画图的各项参数，方便用户的不同需求
       3. 修改HumanTG的编辑回复功能，可以支持各种回复类型（前提是适配器支持）
       注意：这个版本最主要是加入了画图功能，如果不需要画图也可以不更新，因为新的调用方式我没有深入测试，不确定比原作者的got方式更好，更新的话需要同步更新prompts.json文件
v1.0.4 适配无界3.0      

todo（其实是我想做不会做，大佬带我~~~~~）
1.用更优雅的方式实现HumanTG的编辑回复和直接回复的切换
2.选择预设角色的时候可以把Prompt直接显示出来，方便调整（下拉列表框和文本框联动）
3.添加画图功能（大佬的代码已经实现了，我没有4.0的ApiKey，无法测试）✔
*/

/** Code Encryption Block[be188605b2af9d5e9f0e7db22a9634fc212a7ad0a1e72494f09b567ed405599e3a6969c7bfc1217e57a59f2120e0f9542850a3d41954a72effbd7a1d5c4eab4bf188beb4f3e3dbec38f4ae588c4f37080b06085c349e7e725519765f0d138b461a28ed42fe7e883b0eb70234cde01738624108424084077d17630ced0cb199a8171e6aaf17cf64933c3ef4c8b1e11daadde35f592c013bf37ee4537a95dd3a7c2b22416cf55052d6073c6cc14edab78009a388351d452c06f44272ae84fb6586c8ed5b4667bf2859ed80006e6f9917c97962b44b4a62fa01dddef3e2a2930d71e9755cb394163dcf128776391432d9528817c6038102c423901d74337e5c64d1a4dad09cba43d2b36fb68709a492d09709e199ec9a771e24ec4c0d4df081dc0828e0ad53717353e89be6adacf7ccf1b19ec78689f626e7bd579f6a10dee001a0805f762c2705d5d827ae6cdef329fd1d62ec97b183842d746399f838ea8fd1435f66369fcd24ef4d5b95b9aa17d21bc18fe47d5fa158521748e272dcceaa5438e6eaefb670c07951360e05dcfb3c43b0df94f5cf31d52c5d6136e0ccf26d0facc20147b1c7323947bb74fb30762ec7f10db7fcc4b341dbab73c65d8ffb9ccf35979f426b77d8043598776fb56a022945707bee5b457786063aca615a6440995c0485e11f64d225e3ed88c5e045e61eaed14fa9b8b476d689bdd2a0a748ef64359fd19700550464bc4af1654d07f2e976130ee1ad22080022b05adce55841009b1d144d62e4cda124ec6f6022ab885b195fa125ff7e30d236f13414a6763acb6f59efb5be5653cc86b5fae9164fc48a6b4f8b67e24aef13b523006385a6a6b70b78d3686d8a0c9fd5c6719f653820fbe9dc81732576b0e4e2df0f3bc19456c1c1b652e2dac62b0d2acddd98f61510f7bab6790e2d422edd5f2f3d47ceced733d120a6f5898c9086d9b7d603973a1fbeca92a5a366afd4044e848ce05b23728ae9178ba4581ad30235eca5bb22e20e5c402bba201d28d268af98bca185ce728807bb9629af18ee91aec89f2c49615fe4c7f008a7b31b7e1922908b6b75e4c82b9188f351c0c5dfeea08e144648331439924af18b90ea0cb15473249d14eccaecf3f32de74a94e51acc845a8b078ff927a70c0bd248d7c3f2603abaefd9a17c1567941a7f606d7648644fed398378338e68431ac196dac9ecc06030483a97bc64fc3188cde16b40e326915fbce1abaf1bd3e8e71a2802d832f4ec254f2afb29c3f1d701b6a0b485bfb284f36e36d8756e2a8416db92ca0030d88759e60c74ceb15b48c920ae7761ce11c36583f9e48be1da8268ccf66ab805a2df14c345dd5f8fceb954de18a576bf7e615c4284ae16c771723cddb4817a6061ca3fc04dec6d5849de0a7eb48cfccef79acb2856998cdba2e1fd07eacd2f57e2d4bcce2a22bcff343bb81102ec26b57ad9ff3a9a6ed01738afd9efc0f242a6da39b67271b87cc3b817a536ba3c54e9c5222d3ec03c5916c4b1c954aec8eccbf112672c00ee22ed15a2cf394fcc893e55bbefea0490e649a8501dec5689a8b2c99d9cb836c2f57c92b3448f3538fa6998a918f0288a18bd41abea9718dbf16790bdc0c784bd028ce25f95faf99e8df4dbc0a61f0bef542fc9a7c5ba84cf5b39de9a60f5e2de8a6bd9e3d4fa56fc4e7b398ecaac1423e011c0e924ac86dcb92c42ef3ab472486e2cfe2bc85d567c1bd01fbbc0499ca509d5934596c58bca63100ba37d3c0cafbde37f2bf3941af200da90136ed9624f69357f05295176b8ac367e010371452269ba63261e21214f695b5294b237cccfadc2fc965992d3e16631edd6b42b07a070f13ae5c251d95595f5642491a6beda2e0a8cb12c1ae0707303af31489eb8d42510c50aeaacc3e4f1b742847de800c18c3b4f87ea1adcb5297c3f56a5c6f7acb64dc028d02535c291a44d7a895a0e35d4d6fcf3e1c0f42c1d9e39cee166fe3966ba494eeffba24d7724bf578dbf6450925b0f5bc716643f804f1ee063719d1238dc650cb92e4b851711f2ccf0f4a6303c2a62918a8c151553de489f8d50e2dbbfcf305e0f0918b20b8573341522ed2cc91bdc06acb01fae35ccaee8620319fae6b66f8adaadc9bac4c5337a9ef15a51f13940cf612766b51d13d083145a23baeaff66ad153a6f9fe244bde6970ab0ba82d30a19ef6f6bb52acb435abf93c1131f8f6abc0498a0dd9a857208f903b0bf2a24149e304fe951460ed0c69b68a6d64ae0c1468315198419ae84eeef99e1918ae93247085e55702f64c7a2e07b8a94e19e9160eb1e2cdebf642b8687355e7c4af7d766fe8fad4665b8ab82c1055595f5e12d6aac087d53f15ce1617bf276aed5c82292bb3c64064ecf13dfe59392b76573e90219dd347ba078b9cde15bb8ba028507f68e84d1295f988424caaccbd59ea662dbd8765c044110993131a76af31052e7d92de32e527be5d219d3545cb9373dbd9491c53daad06f242c35e8f754717909e7c2be47a846a5ad2d83d6d39d8493447d68f219d9a7e55857acd9e801075c020a8261de5ac80235d432b17b2dedf7a8515fec66abb2ac79f73a60d62daabdc36038ed3464ba9572b32631b4ae470efecb2ed98a247b49d41c764bdf67f4614db59b955d48ae245f44e9d843b28402904821bac9379687424b4063686824a2511e6c937c78e4f53c9ad08ff1af713f172dca9c5b68e7ff72a5cf51673c2bd4cb24273811a6fe5a2d09e121a55b3a1479341a53a390b0f806d0544d037456008e35d28a20a410a9ad55fa6da4ff3d66f5eff14f098df384769e18d518a894937e2503a2930c287f844e648415331be58ede1f51564920f1829c9d0ba649ece01c77676c685806460388f8d67cc2005b5e3eb285b6e3eae40493ab97624690b6f66957dc6f329668cb4a6dd92d3fb3eb4d1f55049157857d164004c818de29149d8c786ac822800880969a4a74062562cfbf2f42a069bfa4cfdd9df88eda11717b391a1a7bcb731057196773da0f43c3c85f1816f47afdef9b969e6b7495cded072fdb8f11440a95861618b611adc164bb99ddb80ec92275bdac8be6d091ee8569bca501904cdcce7ba19e71171ebbd6d8e0c16ecb4573832c3ac69009680af6a8a2ded5e5cc03b345ba8a505f62dc669f38fb43d2a1f0c167bd557b180128d3ae282f8845760b1fa662483a4bfea38c340a60dab3a4da10f79b7e1b92c575e1b0918ea1c2923661af70fc96033ef9487a23df3815ef8933b7b60f4f6998cf65eeb49fce03173fb21e72f6d9271d340bbadfea8107120e43e39189e578ed777641e83216fc941044e2a1718557aa3fe29de39db5c96eaff3758f29ab7bf73f25d3af8c5175d8e775973ff1ee3bcb36a9be1060e2ea8873ba5a67c6a2754b1648cd26eb93c5cb642e59096c472b78c210b100cec7a74bbfe26ee8f20610df7b96a4743645f30a22061e9b17d6ab4078701317cd78efaf17eb6726310f0ea38ea7219d6a108665d6a7deb7891522e7fc72435b88239c33d148ee9f873e2331c98914ad18569e5d36fd48ce4d9cf72388d83a00661eaa607f8ffdb91be97d18261c954cb1c48c0660854b57b4979ffbd0dec26ff02c019af0c4c070396d689afc6132334a219406edaf0efe46a7a2157feeb5ce39d7114a89008b93105a636dcf0dd76aba52b9cb82843d65f6fbeb8d32d09d6f38027762e1028791780f1f0cf31706966a5d246f63461f3531f3edea3978c843210f389a43dfd13de246c03f4803852d3e9f226d6e0f9dc14bc5af7e96cbd63662137137fea09ed6390984870e84e3e0a9da129b4637ba783a2623d2830714cf450faae970f66c67683d98696666a11f5e013c005a1952f13b56478bf6e30f42f4d701aef122b3d572eb205cefa2c712b2047e16c7845674710e3fce7f226e053f18a12763e43c61163c92d30c407126ae2d236cd750d0c01d7c224222b54f49a833dc324826e449ba137eb42cf11d2f44e863151e44d5b58b20d327a41bb4dbaaa52d2fb31a8a467c1bc547a4a4c5172eb103d9adf18659602dd739a982a31cb6679e4e048a72a3f5221acee7b28ddfe9f863b478040d44e889eeb33e2e11329c67ba158e5606cd199d1ce0b52979699440c9ef89a50badd83d1d4168e30c7fd4d37eee945c0cf20ff320c1ebfbb9121bb38ddb93c7673f9763477d70b2141b90538d9320121ed94ee31fc1b24940c7a7127bf6dbfa8822376a9c1390bc609d905aff98242807aae822e4ea12512b8d08f46b46aae836aca39bd8abc9d48e5889d1f1048f3a50c72ab73ab7adef47152fa0dedf863a11bd9f5703da06aa69cc069fe4afad279f2cf5e910e93c431d43ea84f90730c30f0e4cd18b1de80e6c88a586bf49b4338c0157e568345452b0cd797ff619744e3c6ed730d84d5290df06ee81acd834a6124dfa9ea2a2eb9b94763c27a7781d0561d85ac88b27291f74168d3abd5ca59b3eb0bb842e33ceab0ba597277f54122cfece4aa0b6b1fe0411f06e20eda7cd5f83f73c75aa293b39f5422197866aafefa15c203de2e5428dc1ed5e3426ad36073196670113d0cd7ae2a85348db74ed5a6c1b036169c5c806a8694a557a5f0fb057f47f63f2d85607b798ae7ed75b357983221358cbdf3851ba810373af0b1eced8e5c5a94b0f44886ca2ad900ef06188979e0e1618feb898927a568b6beb388a31d15877fd4ea8bf8e1ccd6ed768adc8545c02fcd6ff4eb0debe9732498d78792c2aa01b6ff4f00c2985257716d6ab66e4a2264c94af1c4eca265bc7088870c584fad65f08fe84c48bba6b80d95b07d39537b8a11c7ee153a3a2a47f790b919bcae5108342c726eadfec5e0471ca249b31461e164ba82abf9370e97f8b518424bedfce26235bf0e7f3fc57f71505f7a3ab3fe6800664c26265741eb8bdedf9b7fb7f9130625cf5893c9aa8c5fa16957ec5d4d7993076a4344cc213604ec7850ce0dc0dc18d9e040097995ede38ca584ac2eb54a29f7c989a80e3effc6b494453183499332ee01b25d8569475f7090874ac9efc0089e4355f6d28b2eb87164df6614454e2bddcad9f297c88aa826bedd75bb85e4a9142f9fed38bddb21cf0c74fb14f847dbc9ef4885b4625438934df09a89e158914182d27f436c7411b182c816faca3da4624d85fb16e8fa5b824c4f0ad3f1452e6c18d48a4c23f497a45e10bf8ec82e87ce08f60c011d4f855da2a0d12a16c36fc92c0e87cdf990afeed745d88c639ef540650ec2297ad23a82eb6df59c57d0a15dd270d8db1ce37d28ade4ff3104837de992cd3ba9924191b9a52d10f2d74b53ec0f4dc0105c0d7b6d186107e96d3192d9f82ac7bb75d9bd3f64d2cfcdac3a360982de1d4a4493eabf0a8866369361e5d5ec0443cd36967ef8bc07d2393d8a379f6f2a74a26feb2877b6de2a238950bdbdc1821563c8a33c20890f8f6a794274c4447757ba9cd85a7119eac36b84a90afade77395a7aec58774efe7a5c87e39e83e6c781f6d17e05d1de2d07ed3bea8311a1540384d52f6172da7be4fbe012e8eccc4b7af1f248fef505efbc485b6ffa5777cead725fe5cb323755d9c38468e4e4f3066f8d005c9bb36594887200fa32d825fdf888055f3e0497674a0f3e2ddd408f117a7ec1dd1c7a9ae01ef4f4852cb93dc5d57583fb5ec52b6cf2473d61e4fca56fc00ed8cea6b4db8dcf9b302324d56bc1db2d6889507098c707c3d0cf03afe2996763ffb68fea13fcdf2875157aa95a39cdd3c3402ef258c34f036f780c3e0baadc48475cea2f1c96c0eecf574a99c6e6abfcceaebf67c41000ee64bef385030ff7e1942b8870478bdd880258ad36f4ad760c5c7fa2ead9c4c415a0f0406d7aadda22c06a09611bf432b1ea46bdf4523a0c6151d706137f7c752357719d50a1db35727fb4f3318600c2ad478eddb18ec35c90d1e354338ae025638e7a66a684ae292221726dc87b4aeb9ccb69cd8955e1b4d024eb4fbb60f527b384832d1a60e963df1e961353ed32ac122061e6f1ee4f8388f32e21e5bf9dcdd77ff34645837a8635a55d8a52c1563e4c19997939b1a871d34cc9b9b1d96013d77bf8a6a413425b43def806f7b6fe61ad4a74e4f9d2491c13a5269c5190a7e4f574698ab047f2ffa1a252e816cc0683220754dd1c3e9a7889d7624942b3ab6cccf5cee374e46db2633dbecfc2b8f41796db8935cc3072f4a4c406f7a2c27d5eb1b21ead687aa03999679e9ae61bd01506aea4453cc986ce0ad66705d66c25040e414b6d8b115141a52e7b14f6852cf1fa44a44c67174696d1fc393865409ef8326e4e70eb4f13ed93a21612470a4076ea612ae9fa2adf36fe2bb5df3a76bbcf24ff61b2c3736d4d7c03985f71b6ef69914f99c071100df4cb876936fde6ddd4722872d46b64db9fd0fb6b92c8b7e5a87d678d53dad8698badcc7d197373bbe1be0d717bb55fd73b20e350001248afab45948b01423c205a902d363d0c4e0338de630871d4b83c68a2c32d9238d2e75da02eb993c49aaea37215d71a6443c131af589a8071504f3d59eefa997e61f768aa25e8875907d01dc15a6580f5c55f5f446e753d153e6fd01767f95b066c58bbf313df9e35dd007dd28726459bd00444da095621aad55b7a06cf5d7dc2e7bb41f5b955194401907ef0b72a4587234dcbdb814c6334a3658f43e053292780345cce4f5652cebb7cc36225f1754bcae1da00a5a3042545fb2cae3d993926bb1235464351afa3527a691cbeb2528e17d50a1a2b10b206d4d2231cc071bd2e77fab333ef2b4c1d10b50ad9fa3057800c6fa5fad651b3fd8bf5f50edf672b5e0c2181f06997ff5657a7b394bf2118c34698669de857fc2fbf9f8de1a8b1ea9a36677a7a3bcfd13caf8963755d90ec0ab48844ff7cc91abe8d1b5108d669e1e7e17344e33982f51ead74812f5257935753ba356bf1cad29fd5fc9977105119a4e4a777558f60e62776afc24827954084dfda1a76e6f825518e344994ef5acd51054704702781eb2097499610489b35bc8ab24493eb465317f3378885b611e07d9c16669153ba20ae10cc070320de057a69816111a3809e4bb0f38cc62f62bf6012d9c1bbbd4b8f0742c1b576ecbe4ac7b5be63e48927c6b5a3136230f12d60ed811623f662bc903d88913ed9324ca4b31272724c122509b62a193d6c83783a4960a6d21f7516a66c2ae01a57b1ee9908fbc7115f6cefa2ce5bd3c27401dd74176b02cdbc404f16a256805b85745377c57f7d15e37bfe73f1bedb38941d367c053348e0d9dd50a20e2d6789af1046f6b0543cc6621ca0cf875d2d391a03517b3a7e49ebb8465c1ceab8a64cbe7d91e2a512ecf1f3482bab6c37c38da42a3d56a360f3d562a669ca6d164af38afcac7fa68f528a742d217e3c940fb3c995950a10802c1d3acfaaac0957ac42d7480eeb404f1704f823a282ed0c8298f1dce07af6defa4630337ae1a558c637286ee24a3514e79e79f350dc4e43c08b2c4d42c6edb96735427f86483ef8d0d29eed0b14df7899bb4603b7786bef72176a5fe5cf0772b20b9155edd6357ad538e95a5ecd463b6a540b41b1126d58a2d0f53d60a26f3951c57f6ff40d8b43559afd56d201126472186e5e1097ee0576992ae1bd5021bd8098e799acaeb1edfb133caa51aae1315c9a97bb655a53459b4ac2d3379d1d86be8443d01db0d40b109e648057bbf679e5ed76c2188a13bca99b605c08f7f7f18022dc7083c6f10279d35c6e6661a2224216865255d94e12285a0dd3cafdd3ac792648c9a5fd4356dd38cb912fec3cfd3802b6ef17e9dddb570e9d9e8974c5ebbf00b6a399e9890d420e3c9ea093e3398be88e265197530ae93be0d50689b4bb5d520fd491ddd2a103985df13b6af7f39f2d7a1a084b4e0e2e8bbd47beeff1bc4292b0a0d0212d805caedb0d88626163781d9c8ef29ee98f40d38c5517ae494ba22cc2db9829c3fad050e3de2477b618800ccd691be9118646f77354b00c2dce92456777c97755f3f143ec8c57d1c147d5e29bf417e2b73242a4c02d4e140ab489b96d4ba77e44a97f39d798aad62246f41986b83da9b79ab7fab816166c635b4a8077fd9198de0155ab1e690a0759be8586505edf6f808691801e93eceb7593ab1754a4ecf83e800122602a602383b52f0c9d5f2fde7354f070daea6de6a15e819f30f5814d6440e222eeee33bdd03f1b8fe5697b77bbee725c68c9097b57417b813a2add67da97033577d148d623e363e655729cbce73f3e84cb18cead562750da20ebeb92a5bfbb8aacd1bb2697b3f32ce4e51c8848033d2381d6c6345e0d6b5393a419903319d5009f9166fa319ff8d93abc760edb996422853d005b16c1dc4292c85256b9f714431452a89bf86ab527e32960764feb8e0c25e3e1e67a4fd58eb96949fb81284f637124cdf4717f136386666fd194ce96163d6f50ae50fc1cea4f2c4b139ce37d14a930683dc4e4bd21c4734315c2e95bcbddba0c5976f235f215ceef4da6cd26b32e31db3d3dad2f4619189b5a0240ebb9a105eba1bf023d5f314b805dfed9496d7bfe640c0e57db179c55ea20bd783283262d8253c5ecffcf01b63fbbf80dd4ee702c0d79051638d81f7d9fd3ac73f88c277dc4fc5060f1db3c2b4c6a5a2eb8ab99956b895f098ba8f327375d8c537f9d4068f7ce4a87b75d56d0383f7192986577389d7ff60d0bf642d7d38f468a7f7e9079d852ba3e0d643cb0c2013ad3ae1802c2b814f01b112d473e7c162709dd8cad00819b149e858ab4a234b836192bef1270625dbc698d48622a706a8ddc37dd4d33260843fa0ac2c16c169149b7ffd68267095305fb8551b4e88613a3f2207e2cffb824b4f387c54325459701607c528a25997c45cda86c1f06d85b1c15d5002c6943080c7027469f6fb69b2ba543a8966ad388f3f55379935b8571be66dea5119944a303b7b3782a3581d390c56a64ed2fd778843c3b035eb0f22abfd4663616853d33c43cecf05bf5b1a721be5061cf3e66a5d0e71b0357b004a58b0cd8b7495181e862fbcfa94a8ad62d56ae5a13b524fff862f7f61e8853fb807934028cbcc15665540334670c21bf6c509b4fe74] */